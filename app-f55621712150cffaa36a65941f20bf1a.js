(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?t():'function'==typeof define&&define.amd?define(t):t()})(this,function(){'use strict';function e(e){let t=ht.length;ht.push((e)=>e.value()),yt.push((e,t)=>e.validate(t)),e.id=t}function t({tag:e}){return e===vt}function n(e){return e===vt}function a(e){let t=[];for(let n,a=0,i=e.length;a<i;a++){if(n=e[a].tag,n===kt)return kt;n===vt||t.push(n)}return o(t)}function i(e){let t=[],n=e.head();for(;null!==n;){let a=n.tag;if(a===kt)return kt;a!==vt&&t.push(a),n=e.nextNode(n)}return o(t)}function s(e){let t=[];for(let n,a=0,i=e.length;a<i;a++){if(n=e[a],n===kt)return kt;n===vt||t.push(n)}return o(t)}function o(e){switch(e.length){case 0:return vt;case 1:return e[0];case 2:return xt.create(e[0],e[1]);default:return Et.create(e);}}function r(e,t){return new Dt(e,t)}function d(e){return e!==Nt}function p(e){if(null===e||e===void 0)throw new Error(`Expected value to be present`);return e}function l(e,t){if(null===e||e===void 0)throw new Error(t);return e}function c(){return new Error('unreachable')}function u(e){return e-4}function m(e,t){if(!e)throw new Error(t||'assertion failure')}function f(e){for(let t,n=1;n<arguments.length;n++){if(t=arguments[n],null===t||'object'!=typeof t)continue;let a=Ft(t);for(let n,i=0;i<a.length;i++)n=a[i],e[n]=t[n]}return e}function g(e){let t=Array(e);for(let n=0;n<e;n++)t[n]=null;return t}function h(e){return e._guid=++jt}function y(e){return e._guid||h(e)}function b(){}function v(){return new b}function k(...e){let t=e[0],n=e[1],a=e[2];if('string'==typeof t)return function(t,n,a){return S(t,n,a,e)};return a?S(t,n,a,[]):void C(t,n)}function S(e,t,n,a){let i=x(e);return i.trackedProperties[t]=!0,i.trackedPropertyDependencies[t]=a||[],{enumerable:!0,configurable:!1,get:n.get,set:function(){x(this).dirtyableTagFor(t).inner.dirty(),n.set.apply(this,arguments),an()}}}function C(e,t){let n,a=Symbol(t),i=x(e);i.trackedProperties[t]=!0,e[t]!==void 0&&(n=e[t]),Object.defineProperty(e,t,{configurable:!0,get(){return this[a]},set(e){x(this).dirtyableTagFor(t).inner.dirty(),this[a]=e,an()}})}function A(e,t,n){let a=[e.dirtyableTagFor(t)];if(n&&n.length)for(let t=0;t<n.length;t++)a.push(e.tagFor(n[t]));return s(a)}function x(e){let t=e[tn];return t&&T(e,tn)?t:e[tn]=new en(t)}function T(e,t){return nn.call(e,t)}function _(e,t){throw sn.for(e,t)}function D(e,t,n=_){if('object'==typeof e&&e){let n=x(e);return n.tagFor(t)}return vt}function B(e){return'function'==typeof e.toString?e+'':''}function N(e){return O(e)?'':e+''}function P(e){return O(e)?'':H(e)?e:M(e)?e.toHTML():I(e)?e:e+''}function O(e){return null===e||e===void 0||'function'!=typeof e.toString}function M(e){return'object'==typeof e&&null!==e&&'function'==typeof e.toHTML}function I(e){return'object'==typeof e&&null!==e&&'number'==typeof e.nodeType}function L(e){return I(e)&&11===e.nodeType}function H(e){return'string'==typeof e}function F(e){return'object'==typeof e&&null!==e&&e[wn]}function j(e){let t=e.element,n=e.nextSibling;return null===n?t.lastChild:n.previousSibling}function w(e,t,n){return new Xn(e,t,n)}function R(e,t){return new Yn(e,t)}function z(e,t){let n=e.parentElement(),a=e.firstNode(),i=e.lastNode(),s=a;for(;s;){let e=s.nextSibling;if(n.insertBefore(s,t),s===i)return e;s=e}return null}function V(e){let t=e.parentElement(),n=e.firstNode(),a=e.lastNode(),i=n;for(;i;){let e=i.nextSibling;if(t.removeChild(i),i===a)return e;i=e}return null}function W(e){return 3===e.nodeType}function U(e){return 8===e.nodeType}function K(e){let t=e.nodeValue.match(/^%\+bounds:(\d+)%$/);return t&&t[1]?+t[1]:null}function G(e){let t=e.nodeValue.match(/^%\-bounds:(\d+)%$/);return t&&t[1]?+t[1]:null}function X(e){return 1===e.nodeType}function Y(e){return 8===e.nodeType&&'%glimmer%'===e.nodeValue}function Q(e){return 8===e.nodeType&&'%sep%'===e.nodeValue}function Z(e){return 8===e.nodeType&&'%empty%'===e.nodeValue}function J(e){let t=l(e.parentNode,`cannot remove a detached node`),n=e.nextSibling;return t.removeChild(e),n}function q(e,t){for(let n,a=0;a<e.length;a++)if(n=e[a],n.name===t)return n}function $(){return new Error('Not implemented')}function ee(e){return function(t){return Array.isArray(t)&&t[0]===e}}function te(e,t){let n=new ha(t);return e.compile(n),n.compile()}function ne(e,t){return new Ea(e,t)}function ae(e){return'object'==typeof e&&null!==e&&'function'==typeof e.compile}function ie(e,t,n){let a=e[1],i=e[2],s=e[3];se(i,n),s?n.dynamicAttr(a,s,t):n.dynamicAttr(a,null,t)}function se(e,t){Array.isArray(e)?Ia.compile(e,t):t.primitive(e)}function oe(e,t){if(!e)return 0;for(let n=0;n<e.length;n++)se(e[n],t);return e.length}function re(e=new E,t=new ja){return e.add('if',(e,t,n,a,i)=>{if(!e||1!==e.length)throw new Error(`SYNTAX ERROR: #if requires a single argument`);i.startLabels(),i.pushFrame(),i.returnTo('END'),se(e[0],i),i.test('environment'),i.enter(1),i.jumpUnless('ELSE'),i.invokeStatic(p(n)),a?(i.jump('EXIT'),i.label('ELSE'),i.invokeStatic(a),i.label('EXIT'),i.exit(),i.return()):(i.label('ELSE'),i.exit(),i.return()),i.label('END'),i.popFrame(),i.stopLabels()}),e.add('unless',(e,t,n,a,i)=>{if(!e||1!==e.length)throw new Error(`SYNTAX ERROR: #unless requires a single argument`);i.startLabels(),i.pushFrame(),i.returnTo('END'),se(e[0],i),i.test('environment'),i.enter(1),i.jumpIf('ELSE'),i.invokeStatic(p(n)),a?(i.jump('EXIT'),i.label('ELSE'),i.invokeStatic(a),i.label('EXIT'),i.exit(),i.return()):(i.label('ELSE'),i.exit(),i.return()),i.label('END'),i.popFrame(),i.stopLabels()}),e.add('with',(e,t,n,a,i)=>{if(!e||1!==e.length)throw new Error(`SYNTAX ERROR: #with requires a single argument`);i.startLabels(),i.pushFrame(),i.returnTo('END'),se(e[0],i),i.dup(),i.test('environment'),i.enter(2),i.jumpUnless('ELSE'),i.invokeStatic(p(n),1),a?(i.jump('EXIT'),i.label('ELSE'),i.invokeStatic(a),i.label('EXIT'),i.exit(),i.return()):(i.label('ELSE'),i.exit(),i.return()),i.label('END'),i.popFrame(),i.stopLabels()}),e.add('each',(e,t,n,a,i)=>{i.startLabels(),i.pushFrame(),i.returnTo('END'),t&&'key'===t[0][0]?se(t[1][0],i):i.primitive(null),se(e[0],i),i.enter(2),i.putIterator(),i.jumpUnless('ELSE'),i.pushFrame(),i.returnTo('ITER'),i.dup(rn.fp,1),i.enterList('BODY'),i.label('ITER'),i.iterate('BREAK'),i.label('BODY'),i.invokeStatic(p(n),2),i.pop(2),i.exit(),i.return(),i.label('BREAK'),i.exitList(),i.popFrame(),a?(i.jump('EXIT'),i.label('ELSE'),i.invokeStatic(a),i.label('EXIT'),i.exit(),i.return()):(i.label('ELSE'),i.exit(),i.return()),i.label('END'),i.popFrame(),i.stopLabels()}),e.add('-in-element',(e,t,n,a,i)=>{if(!e||1!==e.length)throw new Error(`SYNTAX ERROR: #-in-element requires a single argument`);if(i.startLabels(),i.pushFrame(),i.returnTo('END'),t&&t[0].length){let e=t[0],n=t[1];if(1===e.length&&'nextSibling'===e[0])se(n[0],i);else throw new Error(`SYNTAX ERROR: #-in-element does not take a \`${e[0]}\` option`)}else se(null,i);se(e[0],i),i.dup(),i.test('simple'),i.enter(3),i.jumpUnless('ELSE'),i.pushRemoteElement(),i.invokeStatic(p(n)),i.popRemoteElement(),i.label('ELSE'),i.exit(),i.return(),i.label('END'),i.popFrame(),i.stopLabels()}),e.add('-with-dynamic-vars',(e,t,n,a,i)=>{if(t){let e=t[0],a=t[1];oe(a,i),i.pushDynamicScope(),i.bindDynamicScope(e),i.invokeStatic(p(n)),i.popDynamicScope()}else i.invokeStatic(p(n))}),{blocks:e,inlines:t}}function de(e,t){Ba.compile(e,t)}function pe(e,t,n){let a=new Ea(n,t);for(let s=0;s<e.length;s++)de(e[s],a);return a}function le(e,t){return-1!==e.indexOf(t)}function ce(e,t){return(null===e||le(Ga,e))&&le(Ya,t)}function ue(e,t){return null!==e&&le(Xa,e)&&le(Qa,t)}function me(e,t){return ce(e,t)||ue(e,t)}function fe(e,t,n,a){let i=null;if(null===a||a===void 0)return a;if(M(a))return a.toHTML();i=t?t.tagName.toUpperCase():null;let s=N(a);if(ce(i,n)){let t=e.protocolForURL(s);if(le(Ka,t))return`unsafe:${s}`}return ue(i,n)?`unsafe:${s}`:s}function ge(e,t){let n,a;if(t in e)a=t,n='prop';else{let i=t.toLowerCase();i in e?(n='prop',a=i):(n='attr',a=t)}return'prop'===n&&('style'===a.toLowerCase()||he(e.tagName,a))&&(n='attr'),{normalized:a,type:n}}function he(e,t){let n=Za[e.toUpperCase()];return n&&n[t.toLowerCase()]||!1}function ye(e,t){if(!e)return t;if(!ve(e))return t;let n=e.createElement('div');return class extends t{insertHTMLBefore(e,t,a){if(null===a||''===a)return super.insertHTMLBefore(e,t,a);let i=e.tagName.toLowerCase(),s=Ja[i];return void 0===s?super.insertHTMLBefore(e,t,a):be(e,s,n,a,t)}}}function be(e,t,n,a,i){let s=t.before+a+t.after;n.innerHTML=s;let o=n;for(let s=0;s<t.depth;s++)o=o.childNodes[0];var r=Ee(o,e,i);let d=r[0],p=r[1];return new Xn(e,d,p)}function ve(e){let t=e.createElement('table');try{t.innerHTML='<tbody></tbody>'}catch(t){}finally{if(0!==t.childNodes.length)return!1}return!0}function ke(e,t,n){if(!e)return t;if(!Ce(e,n))return t;let a=e.createElement('div');return class extends t{insertHTMLBefore(e,t,i){return null===i||''===i?super.insertHTMLBefore(e,t,i):e.namespaceURI===n?Se(e,a,i,t):super.insertHTMLBefore(e,t,i)}}}function Se(e,t,n,a){t.innerHTML='<svg>'+n+'</svg>';var i=Ee(t.firstChild,e,a);let s=i[0],o=i[1];return new Xn(e,s,o)}function Ce(e,t){let n=e.createElementNS(t,'svg');try{n.insertAdjacentHTML('beforeend','<circle></circle>')}catch(t){}finally{return 1===n.childNodes.length&&p(n.firstChild).namespaceURI===qa?!1:!0}}function Ae(e,t){return e?xe(e)?class extends t{constructor(e){super(e),this.uselessComment=this.createComment('')}insertHTMLBefore(e,t,n){if(null===n)return super.insertHTMLBefore(e,t,n);let a=!1,i=t?t.previousSibling:e.lastChild;i&&i instanceof Text&&(a=!0,e.insertBefore(this.uselessComment,t));let s=super.insertHTMLBefore(e,t,n);return a&&e.removeChild(this.uselessComment),s}}:t:t}function xe(e){let t=e.createElement('div');return t.innerHTML='first',t.insertAdjacentHTML('beforeend','second'),2!==t.childNodes.length}function Ee(e,t,n){let a=e.firstChild,i=null,s=a;for(;s;)i=s,s=s.nextSibling,t.insertBefore(i,n);return[a,i]}function Te(e,t,n,a){let i,s=t,o=e,r=n,d=r?r.previousSibling:s.lastChild;if(null===a||''===a)return new Xn(s,null,null);null===r?(s.insertAdjacentHTML('beforeend',a),i=s.lastChild):r instanceof HTMLElement?(r.insertAdjacentHTML('beforebegin',a),i=r.previousSibling):(s.insertBefore(o,r),o.insertAdjacentHTML('beforebegin',a),i=o.previousSibling,s.removeChild(o));let p=d?d.nextSibling:s.firstChild;return new Xn(s,p,i)}function _e(e){return e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function De(e,t){let n=e.tagName,a=e.namespaceURI;if(a===$a)return Be(n,t);var i=ge(e,t);let s=i.type,o=i.normalized;return'attr'===s?Be(n,o):Ne(n,o)}function Be(e,t){return me(e,t)?ui:pi}function Ne(e,t){return me(e,t)?ci:Oe(e,t)?mi:Pe(e,t)?fi:li}function Pe(e,t){return'OPTION'===e&&'selected'===t}function Oe(e,t){return('INPUT'===e||'TEXTAREA'===e)&&'value'===t}function Me(e){return!1===e||void 0===e||null===e||'undefined'==typeof e.toString?null:!0===e?'':'function'==typeof e?null:e+''}function Ie({id:e,meta:t,block:n}){let a,i=e||`client-${Oi++}`;return{id:i,meta:t,create:(e,s)=>{let o=s?f({},s,t):t;return a||(a=JSON.parse(n)),new Mi(i,o,e,a)}}}function Le(e){return e[Fi]}function He(e,t){e[Fi]=t}function Fe(e,t){let n=`The '${t}' property on the ${e} was changed after it had been rendered. Properties that change after being rendered must be tracked. Use the @tracked decorator to mark this as a tracked property.`;throw new sn(e,t,n)}function je(){}function we(e){return-1===e.indexOf(':')}function Re(e,t,n,a,i){let s=[e.slice(0,1),null,null,null],o=[e.slice(1),We(t),n,a];return i.component.dynamic(s,Ve,o),!0}function ze(e,t,n,a){let i=[t.slice(0,1),null,null,null],s=[t.slice(1),We(n),null,null];return a.component.dynamic(i,Ve,s),!0}function Ve(e,t,n){let a=t.positional.at(0),i=e.env;return new ps(a,i,n)}function We(e){if(null===e)return null;let t=e[0].map((e)=>`@${e}`);return[t,e[1]]}function Ue(e,t){let n=Ke(t);throw new Error(`You tried to create an action with the {{action}} helper, but the first argument ${n}was ${typeof e} instead of a function.`)}function Ke(e){let t,n,a='';return null===e||void 0===e?a:('parent'in e&&'property'in e?(t=e.parent.value(),n=e.property):'_parentValue'in e&&'_propertyKey'in e&&(t=e._parentValue,n=e._propertyKey),void 0!==n&&(a+=`('${n}' on ${Ge(t)}) `),a)}function Ge(e){let t=typeof e;if(null===e||e===void 0)return t;if('number'==t||'boolean'==t)return e.toString();if(e.debugName)return e.debugName;try{return JSON.stringify(e)}catch(t){}return e.toString()}function Xe(e){return(t,n)=>new cs(e,n)}function Ye(e,t){e.add('component',Re),t.add('component',ze)}function Qe(e){return e.createComponentDefinition!==void 0}function Ze(){}function Je(e){var t=e.split(':');let n=t[0],a=t[1];return!!(n&&a&&0===a.indexOf('/')&&3<a.split('/').length)}function qe(e){return e.rootName!==void 0&&e.collection!==void 0&&e.name!==void 0&&e.type!==void 0}function $e(e){let t=e.type,n=et(e);return n?t+':'+n:t}function et(e){let t=[];if(e.rootName&&t.push(e.rootName),e.collection&&t.push(e.collection),e.namespace&&t.push(e.namespace),e.name&&t.push(e.name),0<t.length){let n=t.join('/');return qe(e)&&(n='/'+n),n}}function tt(e){let t={};if(-1<e.indexOf(':')){var n=e.split(':');let a=n[0],i=n[1];t.type=a;let s;0===i.indexOf('/')?(s=i.substr(1).split('/'),t.rootName=s.shift(),t.collection=s.shift()):s=i.split('/'),0<s.length&&(t.name=s.pop(),0<s.length&&(t.namespace=s.join('/')))}else t.type=e;return t}function nt(e,t){if(!t)throw new Error('Assertion Failed: '+e)}function at(e,t){return Math.random()*(t-e+1)+e}function it(e,t,n,a){let i=at(e,t);for(;i>n&&i<a;)i=Math.random()*(t-e+1)+e;return i}function st(e,t,n){return{x:(e.x-t.x)*pt(n)-(e.y-t.y)*dt(n)+t.x,y:(e.x-t.x)*dt(n)+(e.y-t.y)*pt(n)+t.y}}function ot(e,t){var n=Math.round;let a=[];for(let s=0;s<e;s++)a[s]={x:(-dt(360/e*s*rt/180)+n(2*Math.random()-1)*Math.random()/3)*t,y:(-pt(360/e*s*rt/180)+n(2*Math.random()-1)*Math.random()/3)*t};return a}var rt=Math.PI,dt=Math.sin,pt=Math.cos,lt=Math.min,ct=Math.max;const ut=0,mt=1,ft=NaN;class gt{validate(e){return this.value()===e}}gt.id=0;const ht=[],yt=[];class bt{constructor(e,t){this.type=e,this.inner=t}value(){let e=ht[this.type];return e(this.inner)}validate(e){let t=yt[this.type];return t(this.inner,e)}}ht.push(()=>ut),yt.push((e,t)=>t===ut);const vt=new bt(0,null);ht.push(()=>ft),yt.push((e,t)=>t===ft);const kt=new bt(1,null);ht.push(()=>St),yt.push((e,t)=>t===St);new bt(2,null);let St=mt;class Ct extends gt{static create(e=St){return new bt(this.id,new Ct(e))}constructor(e=St){super(),this.revision=e}value(){return this.revision}dirty(){this.revision=++St}}e(Ct);class At extends gt{constructor(){super(...arguments),this.lastChecked=null,this.lastValue=null}value(){let e=this.lastChecked,t=this.lastValue;return e!==St&&(this.lastChecked=St,this.lastValue=t=this.compute()),this.lastValue}invalidate(){this.lastChecked=null}}class xt extends At{static create(e,t){return new bt(this.id,new xt(e,t))}constructor(e,t){super(),this.first=e,this.second=t}compute(){return ct(this.first.value(),this.second.value())}}e(xt);class Et extends At{static create(e){return new bt(this.id,new Et(e))}constructor(e){super(),this.tags=e}compute(){let e=this.tags,t=-1;for(let n,a=0;a<e.length;a++)n=e[a].value(),t=ct(n,t);return t}}e(Et);class Tt extends At{static create(e){return new bt(this.id,new Tt(e))}constructor(e){super(),this.tag=e,this.lastUpdated=mt}compute(){return ct(this.lastUpdated,this.tag.value())}update(e){e!==this.tag&&(this.tag=e,this.lastUpdated=St,this.invalidate())}}e(Tt);class _t{constructor(){this.lastRevision=null,this.lastValue=null}value(){let e=this.tag,t=this.lastRevision,n=this.lastValue;return t&&e.validate(t)||(n=this.lastValue=this.compute(),this.lastRevision=e.value()),n}invalidate(){this.lastRevision=null}}class Dt extends _t{constructor(e,t){super(),this.tag=e.tag,this.reference=e,this.mapper=t}compute(){let e=this.reference,t=this.mapper;return t(e.value())}}class Bt{constructor(e){this.lastValue=null,this.lastRevision=null,this.initialized=!1,this.tag=e.tag,this.reference=e}peek(){return this.initialized?this.lastValue:this.initialize()}revalidate(){if(!this.initialized)return this.initialize();let e=this.reference,t=this.lastRevision,n=e.tag;if(n.validate(t))return Nt;this.lastRevision=n.value();let a=this.lastValue,i=e.value();return i===a?Nt:(this.lastValue=i,i)}initialize(){let e=this.reference,t=this.lastValue=e.value();return this.lastRevision=e.tag.value(),this.initialized=!0,t}}const Nt='adb3b78e-3d22-4e4b-877a-6317c2c5c145';class Pt{constructor(e){this.inner=e,this.tag=vt}value(){return this.inner}}var Ot;(function(e){e[e.Trace=0]='Trace',e[e.Debug=1]='Debug',e[e.Warn=2]='Warn',e[e.Error=3]='Error'})(Ot||(Ot={}));let Mt;class It{constructor({console:e,level:t}){this.f=Mt,this.force=Mt,this.console=e,this.level=t}skipped(e){return e<this.level}trace(e,{stackTrace:t=!1}={}){this.skipped(Ot.Trace)||(this.console.log(e),t&&this.console.trace())}debug(e,{stackTrace:t=!1}={}){this.skipped(Ot.Debug)||(this.console.log(e),t&&this.console.trace())}warn(e,{stackTrace:t=!1}={}){this.skipped(Ot.Warn)||(this.console.warn(e),t&&this.console.trace())}error(e){this.skipped(Ot.Error)||this.console.error(e)}}let Lt='undefined'==typeof console?new class{log(){}warn(){}error(){}trace(){}}:console;Mt=new It({console:Lt,level:Ot.Trace});const Ht=Ot.Debug;new It({console:Lt,level:Ht});const Ft=Object.keys;let jt=0,wt=Object.create(null,{constructor:{value:void 0,enumerable:!1,writable:!0}});b.prototype=wt;class Rt{constructor(){this.dict=v()}add(e){return'string'==typeof e?this.dict[e]=e:this.dict[y(e)]=e,this}delete(e){'string'==typeof e?delete this.dict[e]:e._guid&&delete this.dict[e._guid]}forEach(e){let t=this.dict,n=Object.keys(t);for(let a=0;n.length;a++)e(t[n[a]])}toArray(){return Object.keys(this.dict)}}class zt{constructor(){this.stack=[],this.current=null}toArray(){return this.stack}push(e){this.current=e,this.stack.push(e)}pop(){let e=this.stack.pop(),t=this.stack.length;return this.current=0===t?null:this.stack[t-1],void 0===e?null:e}isEmpty(){return 0===this.stack.length}}class Vt{constructor(e){this.next=null,this.prev=null,this.value=e}}class Wt{constructor(){this.clear()}static fromSlice(e){let t=new Wt;return e.forEachNode((e)=>t.append(e.clone())),t}head(){return this._head}tail(){return this._tail}clear(){this._head=this._tail=null}isEmpty(){return null===this._head}toArray(){let e=[];return this.forEachNode((t)=>e.push(t)),e}splice(e,t,n){let a;null===n?(a=this._tail,this._tail=t):(a=n.prev,t.next=n,n.prev=t),a&&(a.next=e,e.prev=a)}nextNode(e){return e.next}prevNode(e){return e.prev}forEachNode(e){for(let t=this._head;null!==t;)e(t),t=t.next}contains(e){for(let t=this._head;null!==t;){if(t===e)return!0;t=t.next}return!1}insertBefore(e,t=null){return null===t?this.append(e):(t.prev?t.prev.next=e:this._head=e,e.prev=t.prev,e.next=t,t.prev=e,e)}append(e){let t=this._tail;return t?(t.next=e,e.prev=t,e.next=null):this._head=e,this._tail=e}pop(){return this._tail?this.remove(this._tail):null}prepend(e){return this._head?this.insertBefore(e,this._head):this._head=this._tail=e}remove(e){return e.prev?e.prev.next=e.next:this._head=e.next,e.next?e.next.prev=e.prev:this._tail=e.prev,e}}class Ut{constructor(e,t){this._head=e,this._tail=t}static toList(e){let t=new Wt;return e.forEachNode((e)=>t.append(e.clone())),t}forEachNode(e){for(let t=this._head;null!==t;)e(t),t=this.nextNode(t)}contains(e){for(let t=this._head;null!==t;){if(t===e)return!0;t=t.next}return!1}head(){return this._head}tail(){return this._tail}toArray(){let e=[];return this.forEachNode((t)=>e.push(t)),e}nextNode(e){return e===this._tail?null:e.next}prevNode(e){return e===this._head?null:e.prev}isEmpty(){return!1}}const Kt=new Ut(null,null),Gt=function(){let e='function'==typeof WeakMap;if(!e)return!1;let t=new WeakMap;return'[object WeakMap]'===Object.prototype.toString.call(t)}(),Xt='undefined'!=typeof Uint32Array;Xt?Uint32Array:Array;const Yt=Gt?Object.freeze([]):[];class Qt extends Vt{constructor(e,t){super(e.valueReferenceFor(t)),this.retained=!1,this.seen=!1,this.key=t.key,this.iterable=e,this.memo=e.memoReferenceFor(t)}update(e){this.retained=!0,this.iterable.updateValueReference(this.value,e),this.iterable.updateMemoReference(this.memo,e)}shouldRemove(){return!this.retained}reset(){this.retained=!1,this.seen=!1}}class Zt{constructor(e){this.map=v(),this.list=new Wt,this.tag=e.tag,this.iterable=e}isEmpty(){let e=this.iterator=this.iterable.iterate();return e.isEmpty()}iterate(){let e=this.iterator||this.iterable.iterate();return this.iterator=null,e}has(e){return!!this.map[e]}get(e){return this.map[e]}wasSeen(e){let t=this.map[e];return t&&t.seen}append(e){let t=this.map,n=this.list,a=this.iterable,i=t[e.key]=new Qt(a,e);return n.append(i),i}insertBefore(e,t){let n=this.map,a=this.list,i=this.iterable,s=n[e.key]=new Qt(i,e);return s.retained=!0,a.insertBefore(s,t),s}move(e,t){let n=this.list;e.retained=!0,n.remove(e),n.insertBefore(e,t)}remove(e){let t=this.list;t.remove(e),delete this.map[e.key]}nextNode(e){return this.list.nextNode(e)}head(){return this.list.head()}}class Jt{constructor(e){this.iterator=null;let t=new Zt(e);this.artifacts=t}next(){let e=this.artifacts,t=this.iterator=this.iterator||e.iterate(),n=t.next();return n?e.append(n):null}}var qt;(function(e){e[e.Append=0]='Append',e[e.Prune=1]='Prune',e[e.Done=2]='Done'})(qt||(qt={}));class $t{constructor({target:e,artifacts:t}){this.target=e,this.artifacts=t,this.iterator=t.iterate(),this.current=t.head()}sync(){for(let e=qt.Append;;)switch(e){case qt.Append:e=this.nextAppend();break;case qt.Prune:e=this.nextPrune();break;case qt.Done:return void this.nextDone();}}advanceToKey(e){let t=this.current,n=this.artifacts,a=t;for(;a&&a.key!==e;)a.seen=!0,a=n.nextNode(a);this.current=a&&n.nextNode(a)}nextAppend(){let e=this.iterator,t=this.current,n=this.artifacts,a=e.next();if(null===a)return this.startPrune();let i=a.key;return t&&t.key===i?this.nextRetain(a):n.has(i)?this.nextMove(a):this.nextInsert(a),qt.Append}nextRetain(e){let t=this.artifacts,n=this.current;n=l(n,'BUG: current is empty'),n.update(e),this.current=t.nextNode(n),this.target.retain(e.key,n.value,n.memo)}nextMove(e){let t=this.current,n=this.artifacts,a=this.target,i=e.key,s=n.get(e.key);s.update(e),n.wasSeen(e.key)?(n.move(s,t),a.move(s.key,s.value,s.memo,t?t.key:null)):this.advanceToKey(i)}nextInsert(e){let t=this.artifacts,n=this.target,a=this.current,i=t.insertBefore(e,a);n.insert(i.key,i.value,i.memo,a?a.key:null)}startPrune(){return this.current=this.artifacts.head(),qt.Prune}nextPrune(){let e=this.artifacts,t=this.target,n=this.current;if(null===n)return qt.Done;let a=n;return this.current=e.nextNode(a),a.shouldRemove()?(e.remove(a),t.delete(a.key)):a.reset(),qt.Prune}nextDone(){this.target.done()}}class en{constructor(e){this.tags=v(),this.computedPropertyTags=v(),this.trackedProperties=e?Object.create(e.trackedProperties):v(),this.trackedPropertyDependencies=e?Object.create(e.trackedPropertyDependencies):v()}tagFor(e){let t=this.tags[e];if(t)return t;let n;return(n=this.trackedPropertyDependencies[e])?this.tags[e]=A(this,e,n):this.tags[e]=Ct.create()}dirtyableTagFor(e){let t,n=this.trackedPropertyDependencies[e];return n?(t=this.computedPropertyTags[e],t?t:this.computedPropertyTags[e]=Ct.create()):(t=this.tags[e],t?t:this.tags[e]=Ct.create())}}let tn=Symbol('ember-object'),nn=Object.prototype.hasOwnProperty,an=function(){};class sn extends Error{constructor(e,t,n){super(n),this.target=e,this.key=t}static for(e,t){return new sn(e,t,`The property '${t}' on ${e} was changed after being rendered. If you want to change a property used in a template after the component has rendered, mark the property as a tracked property with the @tracked decorator.`)}}class on{constructor(e){this.element=null,this.debugName=null,this.__args__=null,Object.assign(this,e)}get args(){return this.__args__}set args(e){this.__args__=e,x(this).dirtyableTagFor('args').inner.dirty()}static create(e){return new this(e)}didInsertElement(){}didUpdate(){}willDestroy(){}destroy(){this.willDestroy()}toString(){return`${this.debugName} component`}}var rn;(function(e){e[e.pc=0]='pc',e[e.ra=1]='ra',e[e.fp=2]='fp',e[e.sp=3]='sp',e[e.s0=4]='s0',e[e.s1=5]='s1',e[e.t0=6]='t0',e[e.t1=7]='t1'})(rn||(rn={}));const dn=new class{constructor(){this.evaluateOpcode=g(72).slice()}add(e,t){this.evaluateOpcode[e]=t}evaluate(e,t,n){let a=this.evaluateOpcode[n];a(e,t)}};class pn{constructor(){h(this)}toJSON(){return{guid:this._guid,type:this.type}}}class ln extends pn{constructor(){super(...arguments),this.next=null,this.prev=null}}class cn extends Pt{constructor(e){super(e)}static create(e){return void 0===e?fn:null===e?gn:!0===e?hn:!1===e?yn:'number'==typeof e?new mn(e):new un(e)}get(){return fn}}class un extends cn{constructor(){super(...arguments),this.lengthReference=null}get(e){if('length'===e){let e=this.lengthReference;return null===e&&(e=this.lengthReference=new mn(this.inner.length)),e}return super.get(e)}}class mn extends cn{constructor(e){super(e)}}const fn=new mn(void 0),gn=new mn(null),hn=new mn(!0),yn=new mn(!1);class bn{constructor(e){this.inner=e,this.tag=e.tag}value(){return this.toBool(this.inner.value())}toBool(e){return!!e}}class vn extends _t{constructor(e){super(),this.parts=e,this.tag=a(e)}compute(){let e=[];for(let t,n=0;n<this.parts.length;n++)t=this.parts[n].value(),null!==t&&void 0!==t&&(e[n]=B(t));return 0<e.length?e.join(''):null}}dn.add(1,(e,{op1:t})=>{let n=e.stack,a=e.constants.getFunction(t),i=n.pop(),s=a(e,i);i.clear(),e.stack.push(s)}),dn.add(2,(e,{op1:t})=>{let n=e.constants.getFunction(t);e.stack.push(n(e))}),dn.add(5,(e,{op1:t})=>{let n=e.referenceForSymbol(t);e.stack.push(n)}),dn.add(4,(e,{op1:t})=>{let n=e.stack.pop();e.scope().bindSymbol(t,n)}),dn.add(70,(e,{op1:t})=>{let n=e.constants.getString(t),a=e.scope().getPartialMap(),i=a[n];i===void 0&&(i=e.getSelf().get(n)),e.stack.push(i)}),dn.add(19,(e,{op1:t,op2:n})=>{e.pushRootScope(t,!!n)}),dn.add(6,(e,{op1:t})=>{let n=e.constants.getString(t),a=e.stack.pop();e.stack.push(a.get(n))}),dn.add(7,(e,{op1:t})=>{let n=t?e.constants.getBlock(t):null;e.stack.push(n)}),dn.add(8,(e,{op1:t})=>{e.stack.push(e.scope().getBlock(t))}),dn.add(9,(e,{op1:t})=>{let n=!!e.scope().getBlock(t);e.stack.push(n?hn:yn)}),dn.add(10,(e,{op1:t})=>{let n=e.scope().getBlock(t),a=n&&n.symbolTable.parameters.length;e.stack.push(a?hn:yn)}),dn.add(11,(e,{op1:t})=>{let n=[];for(let a=t;0<a;a--)n.push(e.stack.pop());e.stack.push(new vn(n.reverse()))}),dn.add(20,(e)=>e.pushChildScope()),dn.add(21,(e)=>e.popScope()),dn.add(39,(e)=>e.pushDynamicScope()),dn.add(40,(e)=>e.popDynamicScope()),dn.add(12,(e,{op1:t})=>{e.stack.push(t)}),dn.add(13,(e,{op1:t})=>{e.stack.push(e.constants.getOther(t))}),dn.add(14,(e,{op1:t})=>{let n=e.stack,a=(t&-1073741824)>>>30,i=t&1073741823;0==a?n.push(cn.create(i)):1==a?n.push(cn.create(e.constants.getString(i))):2==a?0==i?n.push(yn):1==i?n.push(hn):2==i?n.push(gn):3==i?n.push(fn):void 0:void 0}),dn.add(15,(e,{op1:t,op2:n})=>{let a=e.fetchValue(t)-n;e.stack.dup(a)}),dn.add(16,(e,{op1:t})=>e.stack.pop(t)),dn.add(17,(e,{op1:t})=>e.load(t)),dn.add(18,(e,{op1:t})=>e.fetch(t)),dn.add(38,(e,{op1:t})=>{let n=e.constants.getArray(t);e.bindDynamicScope(n)}),dn.add(47,(e)=>e.pushFrame()),dn.add(48,(e)=>e.popFrame()),dn.add(49,(e,{op1:t})=>e.enter(t)),dn.add(50,(e)=>e.exit()),dn.add(41,(e)=>{let t=e.stack,n=t.pop();t.push(n?n.compileDynamic(e.env):null)}),dn.add(42,(e,{op1:t})=>{let n=e.constants.getBlock(t),a=n.compileStatic(e.env);e.call(a.handle)}),dn.add(43,(e,{op1:t})=>{let n=e.constants.getOther(t),a=e.stack.pop();n.invoke(e,a)}),dn.add(44,(e,{op1:t})=>e.goto(t)),dn.add(45,(e,{op1:n})=>{let a=e.stack.pop();if(t(a))a.value()&&e.goto(n);else{let t=new Bt(a);t.peek()&&e.goto(n),e.updateWith(new An(t))}}),dn.add(46,(e,{op1:n})=>{let a=e.stack.pop();if(t(a))a.value()||e.goto(n);else{let t=new Bt(a);t.peek()||e.goto(n),e.updateWith(new An(t))}}),dn.add(22,(e)=>e.return()),dn.add(23,(e,{op1:t})=>{e.returnTo(t)});const kn=function(e){return new Pt(!!e.value())},Sn=function(e){return e},Cn=function(e,t){return t.toConditionalReference(e)};dn.add(51,(e,{op1:t})=>{let n=e.stack,a=n.pop(),i=e.constants.getFunction(t);n.push(i(a,e.env))});class An extends ln{constructor(e){super(),this.type='assert',this.tag=e.tag,this.cache=e}evaluate(e){let t=this.cache;d(t.revalidate())&&e.throw()}toJSON(){let e,t=this.type,n=this._guid,a=this.cache;try{e=JSON.stringify(a.peek())}catch(t){e=a.peek()+''}return{args:[],details:{expected:e},guid:n,type:t}}}class xn extends ln{constructor(e,t){super(),this.target=t,this.type='jump-if-not-modified',this.tag=e,this.lastRevision=e.value()}evaluate(e){let t=this.tag,n=this.target,a=this.lastRevision;!e.alwaysRevalidate&&t.validate(a)&&e.goto(n)}didModify(){this.lastRevision=this.tag.value()}toJSON(){return{args:[JSON.stringify(this.target.inspect())],guid:this._guid,type:this.type}}}class En extends ln{constructor(e){super(),this.target=e,this.type='did-modify',this.tag=vt}evaluate(){this.target.didModify()}}class Tn{constructor(e){this.tag=vt,this.type='label',this.label=null,this.prev=null,this.next=null,h(this),this.label=e}evaluate(){}inspect(){return`${this.label} [${this._guid}]`}toJSON(){return{args:[JSON.stringify(this.inspect())],guid:this._guid,type:this.type}}}dn.add(24,(e,{op1:t})=>{e.elements().appendText(e.constants.getString(t))}),dn.add(25,(e,{op1:t})=>{e.elements().appendComment(e.constants.getString(t))}),dn.add(27,(e,{op1:t})=>{e.elements().openElement(e.constants.getString(t))}),dn.add(28,(e,{op1:t})=>{let n=e.constants.getString(t);e.elements().openElement(n)}),dn.add(29,(e)=>{let t=e.stack.pop().value();e.elements().openElement(t)}),dn.add(36,(e)=>{let n,a,i=e.stack.pop(),s=e.stack.pop();if(t(i))n=i.value();else{let t=new Bt(i);n=t.peek(),e.updateWith(new An(t))}if(t(s))a=s.value();else{let t=new Bt(s);a=t.peek(),e.updateWith(new An(t))}e.elements().pushRemoteElement(n,a)}),dn.add(37,(e)=>e.elements().popRemoteElement()),dn.add(33,(e)=>{let t=e.fetchValue(rn.t0);t&&(t.flush(e),e.loadValue(rn.t0,null)),e.elements().flushElement()}),dn.add(34,(e)=>e.elements().closeElement()),dn.add(35,(e,{op1:t})=>{let a=e.constants.getOther(t),i=e.stack,s=i.pop();var o=e.elements();let r=o.constructing,d=o.updateOperations,p=e.dynamicScope(),l=a.create(r,s,p,d);s.clear(),e.env.scheduleInstallModifier(l,a);let c=a.getDestructor(l);c&&e.newDestroyable(c);let u=a.getTag(l);n(u)||e.updateWith(new _n(u,a,l))});class _n extends ln{constructor(e,t,n){super(),this.tag=e,this.manager=t,this.modifier=n,this.type='update-modifier',this.lastUpdated=e.value()}evaluate(e){let t=this.manager,n=this.modifier,a=this.tag,i=this.lastUpdated;a.validate(i)||(e.env.scheduleUpdateModifier(n,t),this.lastUpdated=a.value())}toJSON(){return{guid:this._guid,type:this.type}}}dn.add(30,(e,{op1:t,op2:n,op3:a})=>{let i=e.constants.getString(t),s=e.constants.getString(n),o=a?e.constants.getString(a):null;e.elements().setStaticAttribute(i,s,o)}),dn.add(31,(e,{op1:n,op2:a,op3:i})=>{let s=e.constants.getString(n),o=e.stack.pop(),r=o.value(),d=i?e.constants.getString(i):null,p=e.elements().setDynamicAttribute(s,r,!!a,d);t(o)||e.updateWith(new Dn(o,p))});class Dn extends ln{constructor(e,t){super(),this.reference=e,this.attribute=t,this.type='patch-element',this.tag=e.tag}evaluate(e){let t=this.attribute,n=this.reference;t.update(n.value(),e.env)}}class Bn{constructor(){this.stack=null,this.positional=new Nn,this.named=new On}empty(){return this.setup(null,!0),this}setup(e,t){this.stack=e;let n=e.fromTop(0),a=n.length,i=e.fromTop(a+1),s=this.positional;s.setup(e,i+a+2,i);let o=this.named;o.setup(e,a,n,t)}get tag(){return a([this.positional,this.named])}get length(){return this.positional.length+this.named.length}at(e){return this.positional.at(e)}get(e){return this.named.get(e)}capture(){return{tag:this.tag,length:this.length,positional:this.positional.capture(),named:this.named.capture()}}clear(){let e=this.stack,t=this.length;e.pop(t+2)}}class Nn{constructor(){this.length=0,this.stack=null,this.start=0,this._tag=null,this._references=null}setup(e,t,n){this.stack=e,this.start=t,this.length=n,this._tag=null,this._references=null}get tag(){let e=this._tag;return e||(e=this._tag=a(this.references)),e}at(e){let t=this.start,n=this.length;if(0>e||e>=n)return fn;return this.stack.fromTop(t-e-1)}capture(){return new Pn(this.tag,this.references)}get references(){let e=this._references;if(!e){let t=this.length;e=this._references=Array(t);for(let n=0;n<t;n++)e[n]=this.at(n)}return e}}class Pn{constructor(e,t,n=t.length){this.tag=e,this.references=t,this.length=n}at(e){return this.references[e]}value(){return this.references.map(this.valueOf)}get(e){let t=this.references,n=this.length;if('length'===e)return cn.create(n);let a=parseInt(e,10);return 0>a||a>=n?fn:t[a]}valueOf(e){return e.value()}}class On{constructor(){this.length=0,this._tag=null,this._references=null,this._names=null,this._realNames=Yt}setup(e,t,n,a){this.stack=e,this.length=t,this._tag=null,this._references=null,a?(this._names=n,this._realNames=Yt):(this._names=null,this._realNames=n)}get tag(){return a(this.references)}get names(){let e=this._names;return e||(e=this._names=this._realNames.map(this.sliceName)),e}has(e){return-1!==this.names.indexOf(e)}get(e){let t=this.names,n=this.length,a=t.indexOf(e);if(-1===a)return fn;return this.stack.fromTop(n-a)}capture(){return new Mn(this.tag,this.names,this.references)}get references(){let e=this._references;if(!e){let t=this.names,n=this.length;e=this._references=[];for(let a=0;a<n;a++)e[a]=this.get(t[a])}return e}sliceName(e){return e.slice(1)}}class Mn{constructor(e,t,n){this.tag=e,this.names=t,this.references=n,this.length=t.length,this._map=null}get map(){let e=this._map;if(!e){let t=this.names,n=this.references;e=this._map=v();for(let a,s=0;s<t.length;s++)a=t[s],e[a]=n[s]}return e}has(e){return-1!==this.names.indexOf(e)}get(e){let t=this.names,n=this.references,a=t.indexOf(e);return-1===a?fn:n[a]}value(){let e=this.names,t=this.references,n=v();for(let a,s=0;s<e.length;s++)a=e[s],n[a]=t[s].value();return n}}var In=new Bn;dn.add(56,(e,{op1:t})=>{let n=e.constants.getOther(t),a=e.stack;a.push({definition:n,manager:n.manager,component:null})}),dn.add(57,(e)=>{let n=e.stack,a=n.pop(),i=t(a)?void 0:new Bt(a),s=i?i.peek():a.value();n.push({definition:s,manager:s.manager,component:null}),i&&e.updateWith(new An(i))}),dn.add(58,(e,{op1:t})=>{let n=e.stack;In.setup(n,!!t),n.push(In)}),dn.add(59,(e,{op1:t})=>{let n=e.stack;var a=e.fetchValue(t);let i=a.definition,s=a.manager,o=n.pop(),r=s.prepareArgs(i,o);if(r){o.clear();let e=r.positional,t=r.named,a=e.length;for(let t=0;t<a;t++)n.push(e[t]);n.push(a);let s=Object.keys(t),d=s.length,p=[];for(let e=0;e<d;e++){let a=t[s[e]],i=`@${s[e]}`;n.push(a),p.push(i)}n.push(p),o.setup(n,!1)}n.push(o)}),dn.add(60,(e,{op1:t,op2:a})=>{var i;let s,o,r=e.stack.pop(),d=e.dynamicScope(),p=(i=e.fetchValue(a),s=i.definition,o=i.manager,i),l=o.create(e.env,s,r,d,e.getSelf(),!!(1&t));p.component=l;let c=o.getTag(l);n(c)||e.updateWith(new Fn(c,s.name,l,o,d))}),dn.add(61,(e,{op1:t})=>{var n=e.fetchValue(t);let a=n.manager,i=n.component,s=a.getDestructor(i);s&&e.newDestroyable(s)}),dn.add(65,(e)=>{e.beginCacheGroup(),e.elements().pushSimpleBlock()}),dn.add(62,(e)=>{e.loadValue(rn.t0,new Ln)}),dn.add(32,(e,{op1:t,op2:n,op3:a})=>{let i=e.constants.getString(t),s=e.stack.pop(),o=a?e.constants.getString(a):null;e.fetchValue(rn.t0).setAttribute(i,s,!!n,o)});class Ln{constructor(){this.attributes=v(),this.classes=[]}setAttribute(e,t,n,a){'class'===e&&this.classes.push(t),this.attributes[e]={value:t,namespace:a,trusting:n}}flush(e){for(let n in this.attributes){let a=this.attributes[n],i=a.value,s=a.namespace,o=a.trusting;'class'==n&&(i=new Hn(this.classes));let r=e.elements().setDynamicAttribute(n,i.value(),o,s);t(i)||e.updateWith(new Dn(i,r))}}}class Hn{constructor(e){this.list=e,this.tag=a(e),this.list=e}value(){let e=[],t=this.list;for(let n,a=0;a<t.length;a++)n=N(t[a].value()),n&&e.push(n);return 0===e.length?null:e.join(' ')}}dn.add(67,(e,{op1:t})=>{var n=e.fetchValue(t);let a=n.manager,i=n.component,s=e.fetchValue(rn.t0);a.didCreateElement(i,e.elements().expectConstructing('DidCreateElementOpcode#evaluate'),s)}),dn.add(63,(e,{op1:t})=>{let n=e.fetchValue(t);e.stack.push(n.manager.getSelf(n.component))}),dn.add(64,(e,{op1:t})=>{var n=e.fetchValue(t);let a=n.manager,i=n.definition,s=n.component;e.stack.push(a.layoutFor(i,s,e.env))}),dn.add(68,(e,{op1:t})=>{var n=e.fetchValue(t);let a=n.manager,i=n.component,s=e.elements().popBlock();a.didRenderLayout(i,s),e.env.didCreate(i,a),e.updateWith(new jn(a,i,s))}),dn.add(66,(e)=>e.commitCacheGroup());class Fn extends ln{constructor(e,t,n,a,i){super(),this.tag=e,this.name=t,this.component=n,this.manager=a,this.dynamicScope=i,this.type='update-component'}evaluate(){let e=this.component,t=this.manager,n=this.dynamicScope;t.update(e,n)}toJSON(){return{args:[JSON.stringify(this.name)],guid:this._guid,type:this.type}}}class jn extends ln{constructor(e,t,n){super(),this.manager=e,this.component=t,this.bounds=n,this.type='did-update-layout',this.tag=vt}evaluate(e){let t=this.manager,n=this.component,a=this.bounds;t.didUpdateLayout(n,a),e.env.didUpdate(n,t)}}const wn='COMPONENT DEFINITION [id=e59c754e-61eb-4392-8c4a-2c0ac72bfcd4]';class Rn{constructor(e,t,n){this[wn]=!0,this.name=e,this.manager=t,this.ComponentClass=n}}class zn extends bn{static create(e){return new zn(e)}toBool(e){return F(e)}}dn.add(26,(e,{op1:n})=>{let a,i=e.stack.pop(),s=i.value();a=n?e.elements().appendTrustingDynamicContent(s):e.elements().appendCautiousDynamicContent(s),t(i)||e.updateWith(new Vn(i,a))});class Vn extends ln{constructor(e,t){super(),this.reference=e,this.content=t,this.tag=e.tag}evaluate(e){let t=this.content,n=this.reference;t.update(e.env,n.value())}}let Wn=function(e,t){console.info('Use `context`, and `get(<path>)` to debug this template.'),e===t('this');debugger};class Un{constructor(e,t,n){this.scope=e,this.locals=v();for(let a=0;a<n.length;a++){let i=n[a],s=t[i-1],o=e.getSymbol(i);this.locals[s]=o}}get(e){let t=this.scope,n=this.locals,a=e.split('.');var i=e.split('.');let s,o=i[0],r=i.slice(1),d=t.getEvalScope();return'this'===o?s=t.getSelf():n[o]?s=n[o]:0===o.indexOf('@')&&d[o]?s=d[o]:(s=this.scope.getSelf(),r=a),r.reduce((e,t)=>e.get(t),s)}}dn.add(71,(e,{op1:t,op2:n})=>{let a=e.constants.getOther(t),i=e.constants.getArray(n),s=new Un(e.scope(),a,i);Wn(e.getSelf().value(),(e)=>s.get(e).value())}),dn.add(69,(e)=>{let t=e.stack,n=t.pop();t.push(n.value().template.asPartial())});class Kn{constructor(e){this.tag=e.tag,this.artifacts=e}value(){return!this.artifacts.isEmpty()}}dn.add(54,(e)=>{let t=e.stack,n=t.pop(),a=t.pop(),i=e.env.iterableFor(n,a.value()),s=new Jt(i);t.push(s),t.push(new Kn(s.artifacts))}),dn.add(52,(e,{op1:t})=>{e.enterList(t)}),dn.add(53,(e)=>e.exitList()),dn.add(55,(e,{op1:t})=>{let n=e.stack,a=n.peek().next();if(a){let t=e.iterate(a.memo,a.value);e.enterItem(a.key,t)}else e.goto(t)});class Gn{constructor(e,t){this.element=e,this.nextSibling=t}}class Xn{constructor(e,t,n){this.parentNode=e,this.first=t,this.last=n}parentElement(){return this.parentNode}firstNode(){return this.first}lastNode(){return this.last}}class Yn{constructor(e,t){this.parentNode=e,this.node=t}parentElement(){return this.parentNode}firstNode(){return this.node}lastNode(){return this.node}}class Qn{constructor(e){this.trusting=e}retry(e,t){let n=this.bounds,a=n.parentElement(),i=V(n),s=aa.forInitialRender(e,a,i);return this.trusting?s.__appendTrustingDynamicContent(t):s.__appendCautiousDynamicContent(t)}}class Zn{constructor(e){this.inner=e,this.bounds=e.bounds}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}update(e,t){let n=this.inner=this.inner.update(e,t);return this.bounds=n.bounds,this}}class Jn extends Qn{constructor(e,t,n){super(n),this.bounds=e,this.lastValue=t}update(e,t){let n=this.lastValue;if(t===n)return this;if(I(t)||M(t))return this.retry(e,t);let a;if(a=O(t)?'':H(t)?t:t+'',a!==n){let e=this.bounds.firstNode();e.nodeValue=this.lastValue=a}return this}}class qn extends Qn{constructor(e,t,n){super(n),this.bounds=e,this.lastValue=t}update(e,t){let n=this.lastValue;return t===n?this:this.retry(e,t)}}class $n extends Qn{constructor(e,t,n){super(n),this.bounds=e,this.lastValue=t}update(e,t){let n=this.lastValue;return t===n?this:M(t)&&t.toHTML()===n.toHTML()?(this.lastValue=t,this):this.retry(e,t)}}class ea extends Qn{constructor(e,t,n){super(n),this.bounds=e,this.lastValue=t}update(e,t){let n=this.lastValue;if(t===n)return this;let a=P(t);return a===n?this:this.retry(e,t)}}class ta{constructor(e){this.node=e}firstNode(){return this.node}}class na{constructor(e){this.node=e}lastNode(){return this.node}}class aa{constructor(e,t,n){this.constructing=null,this.operations=null,this.cursorStack=new zt,this.blockStack=new zt,this.cursorStack.push(new Gn(t,n)),this.env=e,this.dom=e.getAppendOperations(),this.updateOperations=e.getDOM()}static forInitialRender(e,t,n){let a=new this(e,t,n);return a.pushSimpleBlock(),a}static resume(e,t,n){let a=t.parentElement(),i=new this(e,a,n);return i.pushSimpleBlock(),i.pushBlockTracker(t),i}get element(){return this.cursorStack.current.element}get nextSibling(){return this.cursorStack.current.nextSibling}expectConstructing(e){return l(this.constructing,`${e} should only be called while constructing an element`)}expectOperations(e){return l(this.operations,`${e} should only be called while constructing an element`)}block(){return l(this.blockStack.current,'Expected a current block tracker')}popElement(){this.cursorStack.pop(),l(this.cursorStack.current,'can\'t pop past the last element')}pushSimpleBlock(){return this.pushBlockTracker(new ia(this.element))}pushUpdatableBlock(){return this.pushBlockTracker(new oa(this.element))}pushBlockList(e){return this.pushBlockTracker(new ra(this.element,e))}pushBlockTracker(e,t=!1){let n=this.blockStack.current;return null!==n&&(n.newDestroyable(e),!t&&n.didAppendBounds(e)),this.__openBlock(),this.blockStack.push(e),e}popBlock(){return this.block().finalize(this),this.__closeBlock(),l(this.blockStack.pop(),'Expected popBlock to return a block')}__openBlock(){}__closeBlock(){}openElement(e){let t=this.__openElement(e);return this.constructing=t,t}__openElement(e){return this.dom.createElement(e,this.element)}flushElement(){let e=this.element,t=l(this.constructing,`flushElement should only be called when constructing an element`);this.__flushElement(e,t),this.constructing=null,this.operations=null,this.pushElement(t,null),this.didOpenElement(t)}__flushElement(e,t){this.dom.insertBefore(e,t,this.nextSibling)}closeElement(){this.willCloseElement(),this.popElement()}pushRemoteElement(e,t=null){this.pushElement(e,t);let n=new sa(e);this.pushBlockTracker(n,!0)}popRemoteElement(){this.popBlock(),this.popElement()}pushElement(e,t){this.cursorStack.push(new Gn(e,t))}didAddDestroyable(e){this.block().newDestroyable(e)}didAppendBounds(e){return this.block().didAppendBounds(e),e}didAppendNode(e){return this.block().didAppendNode(e),e}didOpenElement(e){return this.block().openElement(e),e}willCloseElement(){this.block().closeElement()}appendText(e){return this.didAppendNode(this.__appendText(e))}__appendText(e){let t=this.dom,n=this.element,a=this.nextSibling,i=t.createTextNode(e);return t.insertBefore(n,i,a),i}appendNode(e){return this.didAppendNode(this.__appendNode(e))}__appendNode(e){return this.dom.insertBefore(this.element,e,this.nextSibling),e}appendFragment(e){return this.didAppendBounds(this.__appendFragment(e))}__appendFragment(e){let t=e.firstChild;if(t){let n=w(this.element,t,e.lastChild);return this.dom.insertBefore(this.element,e,this.nextSibling),n}return R(this.element,this.__appendComment(''))}appendHTML(e){return this.didAppendBounds(this.__appendHTML(e))}__appendHTML(e){return this.dom.insertHTMLBefore(this.element,this.nextSibling,e)}appendTrustingDynamicContent(e){let t=new Zn(this.__appendTrustingDynamicContent(e));return this.didAppendBounds(t),t}__appendTrustingDynamicContent(e){if(L(e)){let t=this.__appendFragment(e);return new qn(t,e,!0)}if(I(e)){let t=this.__appendNode(e);return new qn(R(this.element,t),t,!0)}let t=O(e)?'':M(e)?e.toHTML():H(e)?e:e+'';let n=this.__appendHTML(t);return new ea(n,t,!0)}appendCautiousDynamicContent(e){let t=new Zn(this.__appendCautiousDynamicContent(e));return this.didAppendBounds(t.bounds),t}__appendCautiousDynamicContent(e){if(L(e)){let t=this.__appendFragment(e);return new qn(t,e,!1)}if(I(e)){let t=this.__appendNode(e);return new qn(R(this.element,t),t,!1)}if(M(e)){let t=e.toHTML(),n=this.__appendHTML(t);return new $n(n,e,!1)}let t=O(e)?'':H(e)?e:e+'';let n=this.__appendText(t),a=R(this.element,n);return new Jn(a,t,!1)}appendComment(e){return this.didAppendNode(this.__appendComment(e))}__appendComment(e){let t=this.dom,n=this.element,a=this.nextSibling,i=t.createComment(e);return t.insertBefore(n,i,a),i}__setAttribute(e,t,n){this.dom.setAttribute(this.constructing,e,t,n)}__setProperty(e,t){this.constructing[e]=t}setStaticAttribute(e,t,n){this.__setAttribute(e,t,n)}setDynamicAttribute(e,t,n,a){let i=this.constructing,s=this.env.attributeFor(i,e,n,a),o=new s({element:i,name:e,namespace:a||null});return o.set(this,t,this.env),o}}class ia{constructor(e){this.parent=e,this.first=null,this.last=null,this.destroyables=null,this.nesting=0}destroy(){let e=this.destroyables;if(e&&e.length)for(let t=0;t<e.length;t++)e[t].destroy()}parentElement(){return this.parent}firstNode(){return this.first&&this.first.firstNode()}lastNode(){return this.last&&this.last.lastNode()}openElement(e){this.didAppendNode(e),this.nesting++}closeElement(){this.nesting--}didAppendNode(e){0!==this.nesting||(!this.first&&(this.first=new ta(e)),this.last=new na(e))}didAppendBounds(e){0!==this.nesting||(!this.first&&(this.first=e),this.last=e)}newDestroyable(e){this.destroyables=this.destroyables||[],this.destroyables.push(e)}finalize(e){this.first||e.appendComment('')}}class sa extends ia{destroy(){super.destroy(),V(this)}}class oa extends ia{reset(e){let t=this.destroyables;if(t&&t.length)for(let n=0;n<t.length;n++)e.didDestroy(t[n]);let n=V(this);return this.first=null,this.last=null,this.destroyables=null,this.nesting=0,n}}class ra{constructor(e,t){this.parent=e,this.boundList=t,this.parent=e,this.boundList=t}destroy(){this.boundList.forEachNode((e)=>e.destroy())}parentElement(){return this.parent}firstNode(){let e=this.boundList.head();return e&&e.firstNode()}lastNode(){let e=this.boundList.tail();return e&&e.lastNode()}openElement(){m(!1,'Cannot openElement directly inside a block list')}closeElement(){m(!1,'Cannot closeElement directly inside a block list')}didAppendNode(){m(!1,'Cannot create a new node directly inside a block list')}didAppendBounds(){}newDestroyable(){}finalize(){}}class da extends aa{constructor(e,t,n){if(super(e,t,n),this.lastMatchedNode=null,this.unmatchedAttributes=null,this.blockDepth=0,n)throw new Error('Rehydration with nextSibling not supported');this._candidate=t.firstChild}get candidate(){let e=this._candidate;return e?U(e)&&G(e)===this.blockDepth?null:e:null}clearMismatch(e){if(U(e)){let t=K(e);if(null!==t)return void this.clearBlock(t)}for(let t=e,n=this.nextSibling;t&&t!==n;)t=J(t);this._candidate=null}clearBlock(e){let t=this._candidate;for(;t&&!(U(t)&&G(t)===e);)t=J(t);m(t&&U(t)&&G(t)===e,'An opening block should be paired with a closing block comment'),this._candidate=J(t)}__openBlock(){let e=this.candidate;if(e){if(U(e)){let t=K(e);return null!==t&&(this.blockDepth=t),void(this._candidate=J(e))}this.clearMismatch(e)}}__closeBlock(){let e=this._candidate;if(e){if(U(e)){let t=G(e);return null!==t&&(this.blockDepth=t-1),void(this._candidate=J(e))}this.clearMismatch(e)}}__appendNode(e){let t=this.candidate;return t?t:super.__appendNode(e)}__appendHTML(e){let t=this.markerBounds();if(t){let e=t.firstNode(),n=t.lastNode(),a=w(this.element,e.nextSibling,n.previousSibling);return J(e),J(n),a}return super.__appendHTML(e)}markerBounds(){let e=this._candidate;if(e&&Y(e)){let t=e,n=l(t.nextSibling,`BUG: serialization markers must be paired`);for(;n&&!Y(n);)n=l(n.nextSibling,`BUG: serialization markers must be paired`);return w(this.element,t,n)}return null}__appendText(e){let t=this.candidate;if(t){if(Z(t)){let n=this._candidate=J(t),a=this.dom.createTextNode(e);return this.dom.insertBefore(this.element,a,n),a}return W(t)?(t.nodeValue=e,this.lastMatchedNode=t,this._candidate=t.nextSibling,t):t&&(Q(t)||Z(t))?(this._candidate=t.nextSibling,J(t),this.__appendText(e)):(this.clearMismatch(t),super.__appendText(e))}return super.__appendText(e)}__appendComment(e){let t=this._candidate;return t&&U(t)?(t.nodeValue=e,this.lastMatchedNode=t,this._candidate=t.nextSibling,t):(t&&this.clearMismatch(t),super.__appendComment(e))}__openElement(e){let t=this._candidate;return t&&X(t)&&t.tagName===e.toUpperCase()?(this.unmatchedAttributes=[].slice.call(t.attributes),this._candidate=t.firstChild,t):(t&&this.clearMismatch(t),super.__openElement(e))}__setAttribute(e,t,n){let a=this.unmatchedAttributes;if(a){let n=q(a,e);if(n)return n.value=t,void a.splice(a.indexOf(n),1)}return super.__setAttribute(e,t,n)}__setProperty(e,t){let n=this.unmatchedAttributes;if(n){let a=q(n,e);if(a)return a.value=t,void n.splice(n.indexOf(a),1)}return super.__setProperty(e,t)}__flushElement(e,t){let n=this.unmatchedAttributes;if(n){for(let e=0;e<n.length;e++)this.constructing.removeAttribute(n[e].name);this.unmatchedAttributes=null}else super.__flushElement(e,t)}appendCautiousDynamicContent(e){let t=super.appendCautiousDynamicContent(e);return t.update(this.env,e),t}willCloseElement(){let e=this.candidate;e&&this.clearMismatch(e),this._candidate=this.element.nextSibling,this.lastMatchedNode=this.element,super.willCloseElement()}pushRemoteElement(e=null){throw $()}popRemoteElement(){throw $()}didAppendBounds(e){super.didAppendBounds(e);let t=e.lastNode();return this._candidate=t&&t.nextSibling,e}didOpenElement(e){return super.didOpenElement(e),this._candidate=e.firstChild,e}}class pa extends aa{constructor(){super(...arguments),this.serializeBlockDepth=0}__openBlock(){let e=this.serializeBlockDepth++;this.__appendComment(`%+block:${e}%`),super.__openBlock()}__closeBlock(){super.__closeBlock(),this.__appendComment(`%-block:${--this.serializeBlockDepth}%`)}__appendHTML(e){let t=this.__appendComment('%glimmer%');super.__appendHTML(e);let n=this.__appendComment('%glimmer%');return w(this.element,t,n)}__appendText(e){let t=j(this);return''===e?this.__appendComment('%empty%'):(t&&t.nodeType===Node.TEXT_NODE&&this.__appendComment('%sep%'),super.__appendText(e))}}var la;(function(e){e[e.Text=0]='Text',e[e.Append=1]='Append',e[e.Comment=2]='Comment',e[e.Modifier=3]='Modifier',e[e.Block=4]='Block',e[e.Component=5]='Component',e[e.OpenElement=6]='OpenElement',e[e.FlushElement=7]='FlushElement',e[e.CloseElement=8]='CloseElement',e[e.StaticAttr=9]='StaticAttr',e[e.DynamicAttr=10]='DynamicAttr',e[e.Yield=11]='Yield',e[e.Partial=12]='Partial',e[e.DynamicArg=13]='DynamicArg',e[e.StaticArg=14]='StaticArg',e[e.TrustingAttr=15]='TrustingAttr',e[e.Debugger=16]='Debugger',e[e.ClientSideStatement=17]='ClientSideStatement',e[e.Unknown=18]='Unknown',e[e.Get=19]='Get',e[e.MaybeLocal=20]='MaybeLocal',e[e.FixThisBeforeWeMerge=21]='FixThisBeforeWeMerge',e[e.HasBlock=22]='HasBlock',e[e.HasBlockParams=23]='HasBlockParams',e[e.Undefined=24]='Undefined',e[e.Helper=25]='Helper',e[e.Concat=26]='Concat',e[e.ClientSideExpression=27]='ClientSideExpression'})(la||(la={}));var ca;(function(e){e.isUnknown=ee(la.Unknown),e.isGet=ee(la.Get),e.isConcat=ee(la.Concat),e.isHelper=ee(la.Helper),e.isHasBlock=ee(la.HasBlock),e.isHasBlockParams=ee(la.HasBlockParams),e.isUndefined=ee(la.Undefined),e.isClientSide=ee(la.ClientSideExpression),e.isMaybeLocal=ee(la.MaybeLocal),e.isPrimitiveValue=function(e){return!(null!==e)||'object'!=typeof e}})(ca||(ca={}));var ua;(function(e){function t(e){return e[0]===la.StaticAttr||e[0]===la.DynamicAttr||e[0]===la.TrustingAttr}function n(e){return e[0]===la.StaticArg||e[0]===la.DynamicArg}e.isText=ee(la.Text),e.isAppend=ee(la.Append),e.isComment=ee(la.Comment),e.isModifier=ee(la.Modifier),e.isBlock=ee(la.Block),e.isComponent=ee(la.Component),e.isOpenElement=ee(la.OpenElement),e.isFlushElement=ee(la.FlushElement),e.isCloseElement=ee(la.CloseElement),e.isStaticAttr=ee(la.StaticAttr),e.isDynamicAttr=ee(la.DynamicAttr),e.isYield=ee(la.Yield),e.isPartial=ee(la.Partial),e.isDynamicArg=ee(la.DynamicArg),e.isStaticArg=ee(la.StaticArg),e.isTrustingAttr=ee(la.TrustingAttr),e.isDebugger=ee(la.Debugger),e.isClientSide=ee(la.ClientSideStatement),e.isAttribute=t,e.isArgument=n,e.isParameter=function(e){return t(e)||n(e)},e.getParameterName=function(e){return e[1]}})(ua||(ua={}));var ma;(function(e){e[e.OpenComponentElement=0]='OpenComponentElement',e[e.DidCreateElement=1]='DidCreateElement',e[e.SetComponentAttrs=2]='SetComponentAttrs',e[e.DidRenderLayout=3]='DidRenderLayout',e[e.FunctionExpression=4]='FunctionExpression',e[e.Debugger=5]='Debugger'})(ma||(ma={}));class fa{constructor(e){this.handle=e}}class ga{constructor(e,t){this.handle=e,this.symbolTable=t}}class ha{constructor(e){this.env=e}wrapLayout(e){this.inner=new ya(this.env,e)}fromLayout(e,t){this.inner=new ba(this.env,e,t)}compile(){return this.inner.compile()}get tag(){return this.inner.tag}get attrs(){return this.inner.attrs}}class ya{constructor(e,t){this.env=e,this.layout=t,this.tag=new va,this.attrs=new ka}compile(){let e=this.env,t=this.layout,n={templateMeta:t.meta,symbols:t.symbols,asPartial:!1},a=this.tag.getDynamic(),i=this.tag.getStatic(),s=ne(e,n);if(s.startLabels(),a?(s.fetch(rn.s1),se(a,s),s.dup(),s.load(rn.s1),s.test('simple'),s.jumpUnless('BODY'),s.fetch(rn.s1),s.putComponentOperations(),s.openDynamicElement()):i&&(s.putComponentOperations(),s.openElementWithOperations(i)),a||i){s.didCreateElement(rn.s0);let e=this.attrs.buffer;s.setComponentAttrs(!0);for(let t=0;t<e.length;t++)de(e[t],s);s.setComponentAttrs(!1),s.flushElement()}s.label('BODY'),s.invokeStatic(t.asBlock()),a?(s.fetch(rn.s1),s.test('simple'),s.jumpUnless('END'),s.closeElement()):i&&s.closeElement(),s.label('END'),s.didRenderLayout(rn.s0),a&&s.load(rn.s1),s.stopLabels();let o=s.start,r=s.finalize();return new ga(o,{meta:n,hasEval:t.hasEval,symbols:t.symbols.concat([_a])})}}class ba{constructor(e,t,n){this.env=e,this.componentName=t,this.layout=n,this.attrs=new ka}get tag(){throw new Error('BUG: Cannot call `tag` on an UnwrappedBuilder')}compile(){let e=this.env,t=this.layout;return t.asLayout(this.componentName,this.attrs.buffer).compileDynamic(e)}}class va{constructor(){this.isDynamic=null,this.isStatic=null,this.staticTagName=null,this.dynamicTagName=null}getDynamic(){if(this.isDynamic)return this.dynamicTagName}getStatic(){if(this.isStatic)return this.staticTagName}static(e){this.isStatic=!0,this.staticTagName=e}dynamic(e){this.isDynamic=!0,this.dynamicTagName=[la.ClientSideExpression,ma.FunctionExpression,e]}}class ka{constructor(){this.buffer=[]}static(e,t){this.buffer.push([la.StaticAttr,e,t,null])}dynamic(e,t){this.buffer.push([la.DynamicAttr,e,[la.ClientSideExpression,ma.FunctionExpression,t],null])}}class Sa{constructor(e){this.builder=e,this.env=e.env}static(e,t){let n=t[0],a=t[1],i=t[2],s=t[3],o=this.builder;o.pushComponentManager(e),o.invokeComponent(null,n,a,i,s)}dynamic(e,t,n){let a=n[0],i=n[1],s=n[2],o=n[3],r=this.builder;if(!e||0===e.length)throw new Error('Dynamic syntax without an argument');let d=this.builder.meta.templateMeta;r.startLabels(),r.pushFrame(),r.returnTo('END'),r.compileArgs(e[0],e[1],!0),r.helper(function(e,n){return t(e,n,d)}),r.dup(),r.test('simple'),r.enter(2),r.jumpUnless('ELSE'),r.pushDynamicComponentManager(),r.invokeComponent(null,a,i,s,o),r.label('ELSE'),r.exit(),r.return(),r.label('END'),r.popFrame(),r.stopLabels()}}class Ca{constructor(e,t,n){this.meta=e,this.statements=t,this.parameters=n}scan(){return new Ra(this.statements,{parameters:this.parameters,meta:this.meta})}}class Aa{constructor(){this.labels=v(),this.targets=[]}label(e,t){this.labels[e]=t}target(e,t,n){this.targets.push({at:e,Target:t,target:n})}patch(e){let t=this.targets,n=this.labels;for(let s=0;s<t.length;s++){var a=t[s];let i=a.at,o=a.target,r=n[o]-i;e.heap.setbyaddr(i+1,r)}}}class xa{constructor(e,t,n){this.env=e,this.meta=t,this.program=n,this.labelsStack=new zt,this.isComponentAttrs=!1,this.constants=n.constants,this.heap=n.heap,this.start=this.heap.malloc()}get pos(){return u(this.heap.size())}get nextPos(){return this.heap.size()}upvars(e){return g(e)}reserve(e){this.push(e,0,0,0)}push(e,t=0,n=0,a=0){this.heap.push(e),this.heap.push(t),this.heap.push(n),this.heap.push(a)}finalize(){return this.push(22),this.heap.finishMalloc(this.start),this.start}setComponentAttrs(e){this.isComponentAttrs=e}pushArgs(e){this.push(58,!0===e?1:0)}get labels(){return l(this.labelsStack.current,'bug: not in a label stack')}startLabels(){this.labelsStack.push(new Aa)}stopLabels(){let e=l(this.labelsStack.pop(),'unbalanced push and pop labels');e.patch(this.program)}pushComponentManager(e){this.push(56,this.other(e))}pushDynamicComponentManager(){this.push(57)}prepareArgs(e){this.push(59,e)}createComponent(e,t,n){let a=(!0===t?1:0)|(!0===n?1:0)<<1;this.push(60,a,e)}registerComponentDestructor(e){this.push(61,e)}beginComponentTransaction(){this.push(65)}commitComponentTransaction(){this.push(66)}putComponentOperations(){this.push(62)}getComponentSelf(e){this.push(63,e)}getComponentLayout(e){this.push(64,e)}didCreateElement(e){this.push(67,e)}didRenderLayout(e){this.push(68,e)}getPartialTemplate(){this.push(69)}resolveMaybeLocal(e){this.push(70,this.string(e))}debugger(e,t){this.push(71,this.constants.other(e),this.constants.array(t))}dynamicContent(e){this.push(26,e?1:0)}text(e){this.push(24,this.constants.string(e))}openPrimitiveElement(e){this.push(27,this.constants.string(e))}openElementWithOperations(e){this.push(28,this.constants.string(e))}openDynamicElement(){this.push(29)}flushElement(){this.push(33)}closeElement(){this.push(34)}staticAttr(e,t,n){let a=this.constants.string(e),i=t?this.constants.string(t):0;if(this.isComponentAttrs)this.primitive(n),this.push(32,a,1,i);else{let e=this.constants.string(n);this.push(30,a,e,i)}}dynamicAttr(e,t,n){let a=this.constants.string(e),i=t?this.constants.string(t):0;this.isComponentAttrs?this.push(32,a,!0===n?1:0,i):this.push(31,a,!0===n?1:0,i)}comment(e){let t=this.constants.string(e);this.push(25,t)}modifier(e){this.push(35,this.other(e))}putIterator(){this.push(54)}enterList(e){this.reserve(52),this.labels.target(this.pos,52,e)}exitList(){this.push(53)}iterate(e){this.reserve(55),this.labels.target(this.pos,55,e)}setVariable(e){this.push(4,e)}getVariable(e){this.push(5,e)}getProperty(e){this.push(6,this.string(e))}getBlock(e){this.push(8,e)}hasBlock(e){this.push(9,e)}hasBlockParams(e){this.push(10,e)}concat(e){this.push(11,e)}function(e){this.push(2,this.func(e))}load(e){this.push(17,e)}fetch(e){this.push(18,e)}dup(e=rn.sp,t=0){return this.push(15,e,t)}pop(e=1){return this.push(16,e)}pushRemoteElement(){this.push(36)}popRemoteElement(){this.push(37)}label(e){this.labels.label(e,this.nextPos)}pushRootScope(e,t){this.push(19,e,t?1:0)}pushChildScope(){this.push(20)}popScope(){this.push(21)}returnTo(e){this.reserve(23),this.labels.target(this.pos,23,e)}pushDynamicScope(){this.push(39)}popDynamicScope(){this.push(40)}pushImmediate(e){this.push(13,this.other(e))}primitive(e){let t,n=0;switch(typeof e){case'number':t=e;break;case'string':t=this.string(e),n=1;break;case'boolean':t=0|e,n=2;break;case'object':t=2,n=2;break;case'undefined':t=3,n=2;break;default:throw new Error('Invalid primitive passed to pushPrimitive');}this.push(14,n<<30|t)}helper(e){this.push(1,this.func(e))}pushBlock(e){this.push(7,this.block(e))}bindDynamicScope(e){this.push(38,this.names(e))}enter(e){this.push(49,e)}exit(){this.push(50)}return(){this.push(22)}pushFrame(){this.push(47)}popFrame(){this.push(48)}compileDynamicBlock(){this.push(41)}invokeDynamic(e){this.push(43,this.other(e))}invokeStatic(e,t=0){let n=e.symbolTable.parameters,a=n.length,s=lt(t,a);if(this.pushFrame(),s){this.pushChildScope();for(let e=0;e<s;e++)this.dup(rn.fp,t-e),this.setVariable(n[e])}let i=this.constants.block(e);this.push(42,i),s&&this.popScope(),this.popFrame()}test(e){let t;if('const'===e)t=kn;else if('simple'===e)t=Sn;else if('environment'===e)t=Cn;else if('function'==typeof e)t=e;else throw new Error('unreachable');let n=this.constants.function(t);this.push(51,n)}jump(e){this.reserve(44),this.labels.target(this.pos,44,e)}jumpIf(e){this.reserve(45),this.labels.target(this.pos,45,e)}jumpUnless(e){this.reserve(46),this.labels.target(this.pos,46,e)}string(e){return this.constants.string(e)}names(e){let t=[];for(let a,n=0;n<e.length;n++)a=e[n],t[n]=this.constants.string(a);return this.constants.array(t)}symbols(e){return this.constants.array(e)}other(e){return this.constants.other(e)}block(e){return e?this.constants.block(e):0}func(e){return this.constants.function(e)}}class Ea extends xa{constructor(e,t,n=e.program){super(e,t,n),this.component=new Sa(this)}compileArgs(e,t,n){let a=0;if(e){for(let t=0;t<e.length;t++)se(e[t],this);a=e.length}this.pushImmediate(a);let i=Yt;if(t){i=t[0];let e=t[1];for(let t=0;t<e.length;t++)se(e[t],this)}this.pushImmediate(i),this.pushArgs(n)}compile(e){return ae(e)?e.compile(this):e}guardedAppend(e,t){this.startLabels(),this.pushFrame(),this.returnTo('END'),se(e,this),this.dup(),this.test((e)=>{return zn.create(e)}),this.enter(2),this.jumpUnless('ELSE'),this.pushDynamicComponentManager(),this.invokeComponent(null,null,null,null,null),this.exit(),this.return(),this.label('ELSE'),this.dynamicContent(t),this.exit(),this.return(),this.label('END'),this.popFrame(),this.stopLabels()}invokeComponent(e,t,n,a,i=null){this.fetch(rn.s0),this.dup(rn.sp,1),this.load(rn.s0),this.pushBlock(a),this.pushBlock(i),this.compileArgs(t,n,!1),this.prepareArgs(rn.s0),this.beginComponentTransaction(),this.pushDynamicScope(),this.createComponent(rn.s0,null!==a,null!==i),this.registerComponentDestructor(rn.s0),this.getComponentSelf(rn.s0),this.getComponentLayout(rn.s0),this.invokeDynamic(new Pa(e&&e.scan())),this.popFrame(),this.popScope(),this.popDynamicScope(),this.commitComponentTransaction(),this.load(rn.s0)}template(e){return e?new Ca(this.meta,e.statements,e.parameters):null}}var Ta=la;const _a='&attrs';class Da{constructor(e=0){this.offset=e,this.names=v(),this.funcs=[]}add(e,t){this.funcs.push(t),this.names[e]=this.funcs.length-1}compile(e,t){let n=e[this.offset],a=this.names[n],i=this.funcs[a];m(!!i,`expected an implementation for ${0===this.offset?Ta[e[0]]:ma[e[1]]}`),i(e,t)}}const Ba=new Da,Na=new Da(1);Ba.add(Ta.Text,(e,t)=>{t.text(e[1])}),Ba.add(Ta.Comment,(e,t)=>{t.comment(e[1])}),Ba.add(Ta.CloseElement,(e,t)=>{t.closeElement()}),Ba.add(Ta.FlushElement,(e,t)=>{t.flushElement()}),Ba.add(Ta.Modifier,(e,t)=>{let n=t.env,a=t.meta,i=e[1],s=e[2],o=e[3];if(n.hasModifier(i,a.templateMeta))t.compileArgs(s,o,!0),t.modifier(n.lookupModifier(i,a.templateMeta));else throw new Error(`Compile Error ${i} is not a modifier: Helpers may not be used in the element form.`)}),Ba.add(Ta.StaticAttr,(e,t)=>{let n=e[1],a=e[2],i=e[3];t.staticAttr(n,i,a)}),Ba.add(Ta.DynamicAttr,(e,t)=>{ie(e,!1,t)}),Ba.add(Ta.TrustingAttr,(e,t)=>{ie(e,!0,t)}),Ba.add(Ta.OpenElement,(e,t)=>{t.openPrimitiveElement(e[1])}),Na.add(ma.OpenComponentElement,(e,t)=>{t.putComponentOperations(),t.openElementWithOperations(e[2])}),Na.add(ma.DidCreateElement,(e,t)=>{t.didCreateElement(rn.s0)}),Na.add(ma.SetComponentAttrs,(e,t)=>{t.setComponentAttrs(e[2])}),Na.add(ma.Debugger,()=>{debugger}),Na.add(ma.DidRenderLayout,(e,t)=>{t.didRenderLayout(rn.s0)}),Ba.add(Ta.Append,(e,t)=>{let n=e[1],a=e[2];var i=t.env.macros();let s=i.inlines,o=s.compile(e,t)||n;if(!0!==o){let e=Ha.isGet(n),i=Ha.isMaybeLocal(n);a?t.guardedAppend(n,!0):e||i?t.guardedAppend(n,!1):(se(n,t),t.dynamicContent(!1))}}),Ba.add(Ta.Block,(e,t)=>{let n=e[1],a=e[2],i=e[3],s=e[4],o=e[5],r=t.template(s),d=t.template(o),p=r&&r.scan(),l=d&&d.scan();var c=t.env.macros();let u=c.blocks;u.compile(n,a,i,p,l,t)});class Pa{constructor(e){this.attrs=e}invoke(e,t){var n=t.symbolTable;let a=n.symbols,s=n.hasEval,o=e.stack,r=e.pushRootScope(a.length+1,!0);r.bindSelf(o.pop()),r.bindBlock(a.indexOf(_a)+1,this.attrs);let d=null,i=-1;s&&(i=a.indexOf('$eval')+1,d=v());let p=o.pop();for(let n=p.length-1;0<=n;n--){let e=a.indexOf(p[n]),t=o.pop();-1!==e&&r.bindSymbol(e+1,t),s&&(d[p[n]]=t)}let l=o.pop();m('number'==typeof l,'[BUG] Incorrect value of positional argument count found during invoke-dynamic-layout.'),o.pop(l);let c=a.indexOf('&inverse'),u=o.pop();-1!==c&&r.bindBlock(c+1,u),d&&(d['&inverse']=u);let f=a.indexOf('&default'),g=o.pop();-1!==f&&r.bindBlock(f+1,g),d&&(d['&default']=g),d&&r.bindEvalScope(d),e.pushFrame(),e.call(t.handle)}toJSON(){return{GlimmerDebug:'<invoke-dynamic-layout>'}}}Ba.add(Ta.Component,(e,t)=>{let n=e[1],a=e[2],i=e[3],s=e[4];if(t.env.hasComponentDefinition(n,t.meta.templateMeta)){let e=t.template(s),o=[[Ta.ClientSideStatement,ma.SetComponentAttrs,!0],...a,[Ta.ClientSideStatement,ma.SetComponentAttrs,!1]],r=new Ca(t.meta,o,Yt),d=t.env.getComponentDefinition(n,t.meta.templateMeta);t.pushComponentManager(d),t.invokeComponent(r,null,i,e&&e.scan())}else if(s&&s.parameters.length)throw new Error(`Compile Error: Cannot find component ${n}`);else{t.openPrimitiveElement(n);for(let e=0;e<a.length;e++)Ba.compile(a[e],t);if(t.flushElement(),s){let e=s.statements;for(let n=0;n<e.length;n++)Ba.compile(e[n],t)}t.closeElement()}});class Oa{constructor(e,t){this.outerSymbols=e,this.evalInfo=t}invoke(e,t){let n=p(t),a=n.symbolTable.symbols,s=e.scope(),o=e.pushRootScope(a.length,!1);o.bindCallerScope(s.getCallerScope()),o.bindEvalScope(s.getEvalScope()),o.bindSelf(s.getSelf());let r=this.evalInfo,d=this.outerSymbols,l=v();for(let n=0;n<r.length;n++){let e=r[n],t=d[e-1],a=s.getSymbol(e);l[t]=a}let c=s.getEvalScope();for(let n=0;n<a.length;n++){let e=a[n],t=n+1,i=c[e];i!==void 0&&o.bind(t,i)}o.bindPartialMap(l),e.pushFrame(),e.call(n.handle)}}Ba.add(Ta.Partial,(e,t)=>{let n=e[1],a=e[2];var i=t.meta;let s=i.templateMeta,o=i.symbols;t.startLabels(),t.pushFrame(),t.returnTo('END'),se(n,t),t.pushImmediate(1),t.pushImmediate(Yt),t.pushArgs(!0),t.helper(function(e,t){let a=e.env,n=t.positional.at(0);return r(n,(e)=>{if('string'==typeof e&&e){if(!a.hasPartial(e,s))throw new Error(`Could not find a partial named "${e}"`);return a.lookupPartial(e,s)}if(e)throw new Error(`Could not find a partial named "${e+''}"`);else return null})}),t.dup(),t.test('simple'),t.enter(2),t.jumpUnless('ELSE'),t.getPartialTemplate(),t.compileDynamicBlock(),t.invokeDynamic(new Oa(o,a)),t.popScope(),t.popFrame(),t.label('ELSE'),t.exit(),t.return(),t.label('END'),t.popFrame(),t.stopLabels()});class Ma{constructor(e){this.callerCount=e}invoke(e,t){let n=this.callerCount,a=e.stack;if(!t)return e.pushFrame(),void e.pushCallerScope();let i=t.symbolTable,s=i.parameters,o=s?s.length:0,r=lt(n,o);e.pushFrame(),e.pushCallerScope(0<o);let d=e.scope();for(let o=0;o<r;o++)d.bindSymbol(s[o],a.fromBase(n-o));e.call(t.handle)}toJSON(){return{GlimmerDebug:`<invoke-dynamic-yield caller-count=${this.callerCount}>`}}}Ba.add(Ta.Yield,(e,t)=>{let n=e[1],a=e[2],i=oe(a,t);t.getBlock(n),t.compileDynamicBlock(),t.invokeDynamic(new Ma(i)),t.popScope(),t.popFrame(),i&&t.pop(i)}),Ba.add(Ta.Debugger,(e,t)=>{let n=e[1];t.debugger(t.meta.symbols,n)}),Ba.add(Ta.ClientSideStatement,(e,t)=>{Na.compile(e,t)});const Ia=new Da,La=new Da(1);var Ha=ca;Ia.add(Ta.Unknown,(e,t)=>{let n=e[1];t.env.hasHelper(n,t.meta.templateMeta)?Ia.compile([Ta.Helper,n,Yt,null],t):t.meta.asPartial?t.resolveMaybeLocal(n):(t.getVariable(0),t.getProperty(n))}),Ia.add(Ta.Concat,(e,t)=>{let n=e[1];for(let a=0;a<n.length;a++)se(n[a],t);t.concat(n.length)}),La.add(ma.FunctionExpression,(e,t)=>{t.function(e[2])}),Ia.add(Ta.Helper,(e,t)=>{let n=t.env,a=t.meta,i=e[1],s=e[2],o=e[3];if(n.hasHelper(i,a.templateMeta))t.compileArgs(s,o,!0),t.helper(n.lookupHelper(i,a.templateMeta));else throw new Error(`Compile Error: ${i} is not a helper`)}),Ia.add(Ta.Get,(e,t)=>{let n=e[1],a=e[2];t.getVariable(n);for(let n=0;n<a.length;n++)t.getProperty(a[n])}),Ia.add(Ta.MaybeLocal,(e,t)=>{let n=e[1];if(t.meta.asPartial){let e=n[0];n=n.slice(1),t.resolveMaybeLocal(e)}else t.getVariable(0);for(let a=0;a<n.length;a++)t.getProperty(n[a])}),Ia.add(Ta.Undefined,(e,t)=>{return t.primitive(void 0)}),Ia.add(Ta.HasBlock,(e,t)=>{t.hasBlock(e[1])}),Ia.add(Ta.HasBlockParams,(e,t)=>{t.hasBlockParams(e[1])}),Ia.add(Ta.ClientSideExpression,(e,t)=>{La.compile(e,t)});class E{constructor(){this.names=v(),this.funcs=[]}add(e,t){this.funcs.push(t),this.names[e]=this.funcs.length-1}addMissing(e){this.missing=e}compile(e,t,n,a,i,s){let o=this.names[e];if(o===void 0){m(!!this.missing,`${e} not found, and no catch-all block handler was registered`);let o=this.missing,r=o(e,t,n,a,i,s);m(!!r,`${e} not found, and the catch-all block handler didn't handle it`)}else{let e=this.funcs[o];e(t,n,a,i,s)}}}const Fa=new E;class ja{constructor(){this.names=v(),this.funcs=[]}add(e,t){this.funcs.push(t),this.names[e]=this.funcs.length-1}addMissing(e){this.missing=e}compile(e,t){let n=e[1];if(!Array.isArray(n))return['expr',n];let a,i,s;if(n[0]===Ta.Helper)a=n[1],i=n[2],s=n[3];else if(n[0]===Ta.Unknown)a=n[1],i=s=null;else return['expr',n];let o=this.names[a];if(o===void 0&&this.missing){let e=this.missing,o=e(a,i,s,t);return!1===o?['expr',n]:o}if(void 0!==o){let e=this.funcs[o],r=e(a,i,s,t);return!1===r?['expr',n]:r}return['expr',n]}}const wa=new ja;re(Fa,wa);class Ra{constructor(e,t){this.statements=e,this.symbolTable=t,this.compiledStatic=null,this.compiledDynamic=null}compileStatic(e){let t=this.compiledStatic;if(!t){let n=pe(this.statements,this.symbolTable.meta,e);n.finalize();let a=n.start;t=this.compiledStatic=new fa(a)}return t}compileDynamic(e){let t=this.compiledDynamic;if(!t){let n=this.compileStatic(e);t=new ga(n.handle,this.symbolTable)}return t}}var za=la;class Va{constructor(e,t){this.block=e,this.env=t}scanEntryPoint(e){let t=this.block,n=t.statements,a=t.symbols,i=t.hasEval;return new Ra(n,{meta:e,symbols:a,hasEval:i})}scanBlock(e){let t=this.block,n=t.statements;return new Ra(n,{meta:e,parameters:Yt})}scanLayout(e,t,n){let a=this.block,i=a.symbols,s=a.hasEval,o=new Wa(a,this.env,e,t,n);return new Ra(o.scan(),{meta:e,hasEval:s,symbols:i})}}class Wa{constructor(e,t,n,a,i){this.env=t,this.attrs=a,this.componentName=i,this.state=0;let s=e.statements,o=e.symbols;this.statements=s,this.symbols=o,this.meta=n.templateMeta}scan(){let e=this.statements;this.state=0;let t=[];for(let n=0;n<e.length;n++)this.processStatement(this.statements[n],t);return t.push([za.ClientSideStatement,ma.DidRenderLayout]),t}processStatement(e,t){switch(this.state){case 0:this.processBeforeTopLevel(e,t);break;case 1:this.processInTopLevel(e,t);break;case 2:t.push(e);break;default:throw c();}}processBeforeTopLevel(e,t){ua.isComponent(e)?this.processTopLevelComponent(e,t):ua.isOpenElement(e)?this.processIsOpenElement(e,t):t.push(e)}processTopLevelComponent(e,t){let n=e[1],a=e[2],i=e[4];if(this.env.hasComponentDefinition(n,this.meta)&&n!==this.componentName)return t.push(e),void(this.state=2);m(!this.env.hasComponentDefinition(n,this.meta)||n===this.componentName,`Cannot use a component (<${n}>) as the top-level element in the layout of <${this.componentName}>`),this.state=1,t.push([za.ClientSideStatement,ma.SetComponentAttrs,!0]),t.push([za.ClientSideStatement,ma.OpenComponentElement,n]),t.push([za.ClientSideStatement,ma.DidCreateElement]);for(let n=0;n<a.length;n++)this.processStatement(a[n],t);if(this.processStatement([za.FlushElement],t),i){let e=i.statements;for(let n=0;n<e.length;n++)this.processStatement(e[n],t)}this.processStatement([za.CloseElement],t)}processIsOpenElement(e,t){let n=e[1];this.state=1,t.push([za.ClientSideStatement,ma.SetComponentAttrs,!0]),t.push([za.ClientSideStatement,ma.OpenComponentElement,n]),t.push([za.ClientSideStatement,ma.DidCreateElement])}processInTopLevel(e,t){if(m(!ua.isModifier(e),`Cannot use element modifiers ({{${e[1]} ...}}) in the top-level element in the layout of <${this.componentName}>`),ua.isFlushElement(e)){let e=this.symbols,n=this.attrs;this.state=2;let a=e.push(_a);t.push(...n),t.push([za.Yield,a,Yt]),t.push([za.ClientSideStatement,ma.SetComponentAttrs,!1])}t.push(e)}}class Ua{constructor(){this.references=[],this.strings=[],this.expressions=[],this.arrays=[],this.blocks=[],this.functions=[],this.others=[]}getReference(e){return this.references[e-1]}reference(e){let t=this.references.length;return this.references.push(e),t+1}getString(e){return this.strings[e-1]}string(e){let t=this.strings.length;return this.strings.push(e),t+1}getExpression(e){return this.expressions[e-1]}getArray(e){return this.arrays[e-1]}getNames(e){let t=[],a=this.getArray(e);for(let s,n=0;n<a.length;n++)s=a[n],t[n]=this.getString(s);return t}array(e){let t=this.arrays.length;return this.arrays.push(e),t+1}getBlock(e){return this.blocks[e-1]}block(e){let t=this.blocks.length;return this.blocks.push(e),t+1}getFunction(e){return this.functions[e-1]}function(e){let t=this.functions.length;return this.functions.push(e),t+1}getOther(e){return this.others[e-1]}other(e){let t=this.others.length;return this.others.push(e),t+1}}const Ka=['javascript:','vbscript:'],Ga=['A','BODY','LINK','IMG','IFRAME','BASE','FORM'],Xa=['EMBED'],Ya=['href','src','background','action'],Qa=['src'],Za={BUTTON:{type:!0,form:!0},INPUT:{type:!0,form:!0,autocorrect:!0,list:!0},SELECT:{form:!0},OPTION:{form:!0},TEXTAREA:{form:!0},LABEL:{form:!0},FIELDSET:{form:!0},LEGEND:{form:!0},OBJECT:{form:!0}};let Ja={colgroup:{depth:2,before:'<table><colgroup>',after:'</colgroup></table>'},table:{depth:1,before:'<table>',after:'</table>'},tbody:{depth:2,before:'<table><tbody>',after:'</tbody></table>'},tfoot:{depth:2,before:'<table><tfoot>',after:'</tfoot></table>'},thead:{depth:2,before:'<table><thead>',after:'</thead></table>'},tr:{depth:3,before:'<table><tbody><tr>',after:'</tr></tbody></table>'}};const qa='http://www.w3.org/2000/svg',$a='http://www.w3.org/2000/svg',ei={foreignObject:1,desc:1,title:1},ti=Object.create(null);['b','big','blockquote','body','br','center','code','dd','div','dl','dt','em','embed','h1','h2','h3','h4','h5','h6','head','hr','i','img','li','listing','main','meta','nobr','ol','p','pre','ruby','s','small','span','strong','strike','sub','sup','table','tt','u','ul','var'].forEach((e)=>ti[e]=1);let ni='undefined'==typeof document?null:document;class ai{constructor(e){this.document=e,this.setupUselessElement()}setupUselessElement(){this.uselessElement=this.document.createElement('div')}createElement(e,t){let n,a;if(t?(n=t.namespaceURI===$a||'svg'===e,a=ei[t.tagName]):(n='svg'===e,a=!1),n&&!a){if(ti[e])throw new Error(`Cannot create a ${e} inside an SVG context`);return this.document.createElementNS($a,e)}return this.document.createElement(e)}insertBefore(e,t,n){e.insertBefore(t,n)}insertHTMLBefore(e,t,n){return Te(this.uselessElement,e,t,n)}createTextNode(e){return this.document.createTextNode(e)}createComment(e){return this.document.createComment(e)}}var ii;(function(e){class t extends ai{createElementNS(e,t){return this.document.createElementNS(e,t)}setAttribute(e,t,n,a=null){a?e.setAttributeNS(a,t,n):e.setAttribute(t,n)}}e.TreeConstruction=t;let n=t;n=Ae(ni,n),n=ye(ni,n),n=ke(ni,n,$a),e.DOMTreeConstruction=n})(ii||(ii={}));let si=class extends ai{constructor(e){super(e),this.document=e,this.namespace=null}setAttribute(e,t,n){e.setAttribute(t,n)}setAttributeNS(e,t,n,a){e.setAttributeNS(t,n,a)}removeAttribute(e,t){e.removeAttribute(t)}removeAttributeNS(e,t,n){e.removeAttributeNS(t,n)}insertNodeBefore(e,t,n){if(_e(t)){let a=t.firstChild,i=t.lastChild;return this.insertBefore(e,t,n),new Xn(e,a,i)}return this.insertBefore(e,t,n),new Yn(e,t)}insertTextBefore(e,t,n){let a=this.createTextNode(n);return this.insertBefore(e,a,t),a}insertBefore(e,t,n){e.insertBefore(t,n)}insertAfter(e,t,n){this.insertBefore(e,t,n.nextSibling)}};si=function(e,t){return e?xe(e)?class extends t{constructor(e){super(e),this.uselessComment=e.createComment('')}insertHTMLBefore(e,t,n){if(null===n)return super.insertHTMLBefore(e,t,n);let a=!1,i=t?t.previousSibling:e.lastChild;i&&i instanceof Text&&(a=!0,e.insertBefore(this.uselessComment,t));let s=super.insertHTMLBefore(e,t,n);return a&&e.removeChild(this.uselessComment),s}}:t:t}(ni,si),si=function(e,t){if(!e)return t;if(!ve(e))return t;let n=e.createElement('div');return class extends t{insertHTMLBefore(e,t,a){if(null===a||''===a)return super.insertHTMLBefore(e,t,a);let i=e.tagName.toLowerCase(),s=Ja[i];return void 0===s?super.insertHTMLBefore(e,t,a):be(e,s,n,a,t)}}}(ni,si),si=function(e,t,n){if(!e)return t;if(!Ce(e,n))return t;let a=e.createElement('div');return class extends t{insertHTMLBefore(e,t,i){return null===i||''===i?super.insertHTMLBefore(e,t,i):e.namespaceURI===n?Se(e,a,i,t):super.insertHTMLBefore(e,t,i)}}}(ni,si,$a);var oi=si;const ri=ii.DOMTreeConstruction;class di{constructor(e){this.attribute=e}}class pi extends di{set(e,t){let n=Me(t);if(null!==n){var a=this.attribute;let t=a.name,i=a.namespace;e.__setAttribute(t,n,i)}}update(e){let t=Me(e);var n=this.attribute;let a=n.element,i=n.name;null===t?a.removeAttribute(i):a.setAttribute(i,t)}}class li extends di{set(e,t){if(null!==t&&t!==void 0){let n=this.attribute.name;e.__setProperty(n,t)}}update(e){var t=this.attribute;let n=t.element,a=t.name;n[a]=e,(null===e||e===void 0)&&this.removeAttribute()}removeAttribute(){var e=this.attribute;let t=e.element,n=e.name,a=e.namespace;a?t.removeAttributeNS(a,n):t.removeAttribute(n)}}class ci extends li{set(e,t,n){var a=this.attribute;let i=a.element,s=a.name,o=fe(n,i,s,t);super.set(e,o,n)}update(e,t){var n=this.attribute;let a=n.element,i=n.name,s=fe(t,a,i,e);super.update(s,t)}}class ui extends pi{set(e,t,n){var a=this.attribute;let i=a.element,s=a.name,o=fe(n,i,s,t);super.set(e,o,n)}update(e,t){var n=this.attribute;let a=n.element,i=n.name,s=fe(t,a,i,e);super.update(s,t)}}class mi extends li{set(e,t){e.__setProperty('value',N(t))}update(e){let t=this.attribute.element,n=t.value,a=N(e);n!==a&&(t.value=a)}}class fi extends li{set(e,t){null!==t&&t!==void 0&&!1!==t&&e.__setProperty('selected',!0)}update(e){let t=this.attribute.element;t.selected=!!e}}class gi{constructor(e,t,n,a){this.slots=e,this.callerScope=t,this.evalScope=n,this.partialMap=a}static root(e,t=0){let n=Array(t+1);for(let a=0;a<=t;a++)n[a]=fn;return new gi(n,null,null,null).init({self:e})}static sized(e=0){let t=Array(e+1);for(let n=0;n<=e;n++)t[n]=fn;return new gi(t,null,null,null)}init({self:e}){return this.slots[0]=e,this}getSelf(){return this.get(0)}getSymbol(e){return this.get(e)}getBlock(e){return this.get(e)}getEvalScope(){return this.evalScope}getPartialMap(){return this.partialMap}bind(e,t){this.set(e,t)}bindSelf(e){this.set(0,e)}bindSymbol(e,t){this.set(e,t)}bindBlock(e,t){this.set(e,t)}bindEvalScope(e){this.evalScope=e}bindPartialMap(e){this.partialMap=e}bindCallerScope(e){this.callerScope=e}getCallerScope(){return this.callerScope}child(){return new gi(this.slots.slice(),this.callerScope,this.evalScope,this.partialMap)}get(e){if(e>=this.slots.length)throw new RangeError(`BUG: cannot get $${e} from scope; length=${this.slots.length}`);return this.slots[e]}set(e,t){if(e>=this.slots.length)throw new RangeError(`BUG: cannot get $${e} from scope; length=${this.slots.length}`);this.slots[e]=t}}class hi{constructor(){this.scheduledInstallManagers=[],this.scheduledInstallModifiers=[],this.scheduledUpdateModifierManagers=[],this.scheduledUpdateModifiers=[],this.createdComponents=[],this.createdManagers=[],this.updatedComponents=[],this.updatedManagers=[],this.destructors=[]}didCreate(e,t){this.createdComponents.push(e),this.createdManagers.push(t)}didUpdate(e,t){this.updatedComponents.push(e),this.updatedManagers.push(t)}scheduleInstallModifier(e,t){this.scheduledInstallManagers.push(t),this.scheduledInstallModifiers.push(e)}scheduleUpdateModifier(e,t){this.scheduledUpdateModifierManagers.push(t),this.scheduledUpdateModifiers.push(e)}didDestroy(e){this.destructors.push(e)}commit(){let e=this.createdComponents,t=this.createdManagers;for(let n=0;n<e.length;n++){let a=e[n],i=t[n];i.didCreate(a)}let n=this.updatedComponents,a=this.updatedManagers;for(let e=0;e<n.length;e++){let t=n[e],i=a[e];i.didUpdate(t)}let s=this.destructors;for(let e=0;e<s.length;e++)s[e].destroy();let o=this.scheduledInstallManagers,r=this.scheduledInstallModifiers;for(let e=0;e<o.length;e++){let t=o[e],n=r[e];t.install(n)}let d=this.scheduledUpdateModifierManagers,p=this.scheduledUpdateModifiers;for(let e=0;e<d.length;e++){let t=d[e],n=p[e];t.update(n)}}}class yi{constructor(e){this.heap=e,this.offset=0}get type(){return this.heap.getbyaddr(this.offset)}get op1(){return this.heap.getbyaddr(this.offset+1)}get op2(){return this.heap.getbyaddr(this.offset+2)}get op3(){return this.heap.getbyaddr(this.offset+3)}}var bi;(function(e){e[e.Allocated=0]='Allocated',e[e.Freed=1]='Freed',e[e.Purged=2]='Purged',e[e.Pointer=3]='Pointer'})(bi||(bi={}));class vi{constructor(){this.heap=[],this.offset=0,this.handle=0,this.table=[]}push(e){this.heap[this.offset++]=e}getbyaddr(e){return this.heap[e]}setbyaddr(e,t){this.heap[e]=t}malloc(){this.table.push(this.offset,0,0);let e=this.handle;return this.handle+=3,e}finishMalloc(e){let t=this.table[e],n=this.offset;this.table[e+1]=n-t}size(){return this.offset}getaddr(e){return this.table[e]}gethandle(e){this.table.push(e,0,bi.Pointer);let t=this.handle;return this.handle+=3,t}sizeof(){return-1}free(e){this.table[e+2]=1}compact(){let e=0,t=this.table,n=this.table.length,a=this.heap;for(let s=0;s<n;s+=3){let n=t[s],i=t[s+1],o=t[s+2];if(o===bi.Purged)continue;else if(o===bi.Freed)t[s+2]=2,e+=i;else if(o===bi.Allocated){for(let t=n;t<=s+i;t++)a[t-e]=a[t];t[s]=n-e}else o===bi.Pointer&&(t[s]=n-e)}this.offset-=e}}class ki{constructor(){this.heap=new vi,this._opcode=new yi(this.heap),this.constants=new Ua}opcode(e){return this._opcode.offset=e,this._opcode}}class Si{constructor({appendOperations:e,updateOperations:t}){this._macros=null,this._transaction=null,this.program=new ki,this.appendOperations=e,this.updateOperations=t}toConditionalReference(e){return new bn(e)}getAppendOperations(){return this.appendOperations}getDOM(){return this.updateOperations}getIdentity(e){return y(e)+''}begin(){m(!this._transaction,'a glimmer transaction was begun, but one already exists. You may have a nested transaction'),this._transaction=new hi}get transaction(){return l(this._transaction,'must be in a transaction')}didCreate(e,t){this.transaction.didCreate(e,t)}didUpdate(e,t){this.transaction.didUpdate(e,t)}scheduleInstallModifier(e,t){this.transaction.scheduleInstallModifier(e,t)}scheduleUpdateModifier(e,t){this.transaction.scheduleUpdateModifier(e,t)}didDestroy(e){this.transaction.didDestroy(e)}commit(){let e=this.transaction;this._transaction=null,e.commit()}attributeFor(e,t,n=null){return De(e,t)}macros(){let e=this._macros;return e||(this._macros=e=this.populateBuiltins()),e}populateBuiltins(){return re()}}class Ci{constructor(e,{alwaysRevalidate:t=!1}){this.frameStack=new zt,this.env=e,this.constants=e.program.constants,this.dom=e.getDOM(),this.alwaysRevalidate=t}execute(e,t){let n=this.frameStack;for(this.try(e,t);!0&&!n.isEmpty();){let e=this.frame.nextStatement();if(null===e){this.frameStack.pop();continue}e.evaluate(this)}}get frame(){return l(this.frameStack.current,'bug: expected a frame')}goto(e){this.frame.goto(e)}try(e,t){this.frameStack.push(new _i(this,e,t))}throw(){this.frame.handleException(),this.frameStack.pop()}evaluateOpcode(e){e.evaluate(this)}}class Ai extends ln{constructor(e,t,n,a){super(),this.start=e,this.type='block',this.next=null,this.prev=null;let i=t.env,s=t.scope,o=t.dynamicScope,r=t.stack;this.children=a,this.env=i,this.scope=s,this.dynamicScope=o,this.stack=r,this.bounds=n}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}evaluate(e){e.try(this.children,null)}destroy(){this.bounds.destroy()}didDestroy(){this.env.didDestroy(this.bounds)}toJSON(){let e=v();return e.guid=`${this._guid}`,{guid:this._guid,type:this.type,details:e,children:this.children.toArray().map((e)=>e.toJSON())}}}class xi extends Ai{constructor(e,t,n,a){super(e,t,n,a),this.type='try',this.tag=this._tag=Tt.create(vt)}didInitializeChildren(){this._tag.inner.update(i(this.children))}evaluate(e){e.try(this.children,this)}handleException(){let e=this.env,t=this.bounds,n=this.children,a=this.scope,i=this.dynamicScope,s=this.start,o=this.stack,r=this.prev,d=this.next;n.clear();let p=aa.resume(e,t,t.reset(e)),l=new Ni(e,a,i,p),c=new Wt;l.execute(s,(e)=>{e.stack=Bi.restore(o),e.updatingOpcodeStack.push(c),e.updateWith(this),e.updatingOpcodeStack.push(n)}),this.prev=r,this.next=d}toJSON(){let e=super.toJSON(),t=e.details;return t||(t=e.details={}),super.toJSON()}}class Ei{constructor(e,t){this.opcode=e,this.marker=t,this.didInsert=!1,this.didDelete=!1,this.map=e.map,this.updating=e.children}insert(e,t,n,a){let i=this.map,s=this.opcode,o=this.updating,r=null,d=null;a?(d=i[a],r=d.bounds.firstNode()):r=this.marker;let p=s.vmForInsertion(r),l=null,c=s.start;p.execute(c,(a)=>{i[e]=l=a.iterate(n,t),a.updatingOpcodeStack.push(new Wt),a.updateWith(l),a.updatingOpcodeStack.push(l.children)}),o.insertBefore(l,d),this.didInsert=!0}retain(){}move(e,t,n,a){let i=this.map,s=this.updating,o=i[e],r=i[a]||null;a?z(o,r.firstNode()):z(o,this.marker),s.remove(o),s.insertBefore(o,r)}delete(e){let t=this.map,n=t[e];n.didDestroy(),V(n),this.updating.remove(n),delete t[e],this.didDelete=!0}done(){this.opcode.didInitializeChildren(this.didInsert||this.didDelete)}}class Ti extends Ai{constructor(e,t,n,a,i){super(e,t,n,a),this.type='list-block',this.map=v(),this.lastIterated=mt,this.artifacts=i;let o=this._tag=Tt.create(vt);this.tag=s([i.tag,o])}didInitializeChildren(e=!0){this.lastIterated=this.artifacts.tag.value(),e&&this._tag.inner.update(i(this.children))}evaluate(e){let t=this.artifacts,n=this.lastIterated;if(!t.tag.validate(n)){let n=this.bounds,a=e.dom,i=a.createComment('');a.insertAfter(n.parentElement(),i,l(n.lastNode(),'can\'t insert after an empty bounds'));let s=new Ei(this,i),o=new $t({target:s,artifacts:t});o.sync(),this.parentElement().removeChild(i)}super.evaluate(e)}vmForInsertion(e){let t=this.env,n=this.scope,a=this.dynamicScope,i=aa.forInitialRender(this.env,this.bounds.parentElement(),e);return new Ni(t,n,a,i)}toJSON(){let e=super.toJSON(),t=this.map,n=Object.keys(t).map((e)=>{return`${JSON.stringify(e)}: ${t[e]._guid}`}).join(', '),a=e.details;return a||(a=e.details={}),a.map=`{${n}}`,e}}class _i{constructor(e,t,n){this.vm=e,this.ops=t,this.exceptionHandler=n,this.vm=e,this.ops=t,this.current=t.head()}goto(e){this.current=e}nextStatement(){let e=this.current,t=this.ops;return e&&(this.current=t.nextNode(e)),e}handleException(){this.exceptionHandler&&this.exceptionHandler.handleException()}}class Di{constructor(e,t,n){this.env=e,this.updating=t,this.bounds=n}rerender({alwaysRevalidate:e=!1}={alwaysRevalidate:!1}){let t=this.env,n=this.updating,a=new Ci(t,{alwaysRevalidate:e});a.execute(n,this)}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}opcodes(){return this.updating}handleException(){throw'this should never happen'}destroy(){this.bounds.destroy(),V(this.bounds)}}class Bi{constructor(e,t,n){this.stack=e,this.fp=t,this.sp=n}static empty(){return new this([],0,-1)}static restore(e){return new this(e.slice(),0,e.length-1)}isEmpty(){return-1===this.sp}push(e){this.stack[++this.sp]=e}dup(e=this.sp){this.push(this.stack[e])}pop(e=1){let t=this.stack[this.sp];return this.sp-=e,t}peek(){return this.stack[this.sp]}fromBase(e){return this.stack[this.fp-e]}fromTop(e){return this.stack[this.sp-e]}capture(e){let t=this.sp+1;return this.stack.slice(t-e,t)}reset(){this.stack.length=0}toArray(){return this.stack.slice(this.fp,this.sp+1)}}class Ni{constructor(e,t,n,a){this.env=e,this.elementStack=a,this.dynamicScopeStack=new zt,this.scopeStack=new zt,this.updatingOpcodeStack=new zt,this.cacheGroups=new zt,this.listBlockStack=new zt,this.stack=Bi.empty(),this.pc=-1,this.ra=-1,this.s0=null,this.s1=null,this.t0=null,this.t1=null,this.env=e,this.heap=e.program.heap,this.constants=e.program.constants,this.elementStack=a,this.scopeStack.push(t),this.dynamicScopeStack.push(n)}get fp(){return this.stack.fp}set fp(e){this.stack.fp=e}get sp(){return this.stack.sp}set sp(e){this.stack.sp=e}fetch(e){this.stack.push(this[rn[e]])}load(e){this[rn[e]]=this.stack.pop()}fetchValue(e){return this[rn[e]]}loadValue(e,t){this[rn[e]]=t}pushFrame(){this.stack.push(this.ra),this.stack.push(this.fp),this.fp=this.sp-1}popFrame(){this.sp=this.fp-1,this.ra=this.stack.fromBase(0),this.fp=this.stack.fromBase(-1)}goto(e){this.pc=u(this.pc+e)}call(e){let t=this.heap.getaddr(e);this.ra=this.pc,this.pc=t}returnTo(e){this.ra=u(this.pc+e)}return(){this.pc=this.ra}static initial(e,t,n,a,i){let s=gi.root(t,i.symbolTable.symbols.length),o=new Ni(e,s,n,a);return o.pc=o.heap.getaddr(i.handle),o.updatingOpcodeStack.push(new Wt),o}capture(e){return{dynamicScope:this.dynamicScope(),env:this.env,scope:this.scope(),stack:this.stack.capture(e)}}beginCacheGroup(){this.cacheGroups.push(this.updating().tail())}commitCacheGroup(){let e=new Tn('END'),t=this.updating(),n=this.cacheGroups.pop(),a=n?t.nextNode(n):t.head(),s=t.tail(),o=i(new Ut(a,s)),r=new xn(o,e);t.insertBefore(r,a),t.append(new En(r)),t.append(e)}enter(e){let t=new Wt,n=this.capture(e),a=this.elements().pushUpdatableBlock(),i=new xi(this.heap.gethandle(this.pc),n,a,t);this.didEnter(i)}iterate(e,t){let n=this.stack;n.push(t),n.push(e);let a=this.capture(2),i=this.elements().pushUpdatableBlock();return new xi(this.heap.gethandle(this.pc),a,i,new Wt())}enterItem(e,t){this.listBlock().map[e]=t,this.didEnter(t)}enterList(e){let t=new Wt,n=this.capture(0),a=this.elements().pushBlockList(t),i=this.stack.peek().artifacts,s=this.heap.gethandle(u(this.pc+e)),o=new Ti(s,n,a,t,i);this.listBlockStack.push(o),this.didEnter(o)}didEnter(e){this.updateWith(e),this.updatingOpcodeStack.push(e.children)}exit(){this.elements().popBlock(),this.updatingOpcodeStack.pop();let e=this.updating().tail();e.didInitializeChildren()}exitList(){this.exit(),this.listBlockStack.pop()}updateWith(e){this.updating().append(e)}listBlock(){return l(this.listBlockStack.current,'expected a list block')}updating(){return l(this.updatingOpcodeStack.current,'expected updating opcode on the updating opcode stack')}elements(){return this.elementStack}scope(){return l(this.scopeStack.current,'expected scope on the scope stack')}dynamicScope(){return l(this.dynamicScopeStack.current,'expected dynamic scope on the dynamic scope stack')}pushChildScope(){this.scopeStack.push(this.scope().child())}pushCallerScope(e=!1){let t=l(this.scope().getCallerScope(),'pushCallerScope is called when a caller scope is present');this.scopeStack.push(e?t.child():t)}pushDynamicScope(){let e=this.dynamicScope().child();return this.dynamicScopeStack.push(e),e}pushRootScope(e,t){let n=gi.sized(e);return t&&n.bindCallerScope(this.scope()),this.scopeStack.push(n),n}popScope(){this.scopeStack.pop()}popDynamicScope(){this.dynamicScopeStack.pop()}newDestroyable(e){this.elements().didAddDestroyable(e)}getSelf(){return this.scope().getSelf()}referenceForSymbol(e){return this.scope().getSymbol(e)}execute(e,t){this.pc=this.heap.getaddr(e),t&&t(this);let n;for(;n=this.next(),!n.done;);return n.value}next(){let e,t=this.env,n=this.updatingOpcodeStack,a=this.elementStack,i=this.nextStatement(t);return null===i?(this.stack.reset(),e={done:!0,value:new Di(t,l(n.pop(),'there should be a final updating opcode stack'),a.popBlock())}):(dn.evaluate(this,i,i.type),e={done:!1,value:null}),e}nextStatement(e){let t=this.pc;if(-1===t)return null;let n=e.program;return this.pc+=4,n.opcode(t)}evaluateOpcode(e){dn.evaluate(this,e,e.type)}bindDynamicScope(e){let t=this.dynamicScope();for(let n,a=e.length-1;0<=a;a--)n=this.constants.getString(e[a]),t.set(n,this.stack.pop())}}class Pi{constructor(e){this.vm=e}next(){return this.vm.next()}}let Oi=0;class Mi{constructor(e,t,n,a){this.id=e,this.meta=t,this.env=n,this.entryPoint=null,this.layout=null,this.partial=null,this.block=null,this.scanner=new Va(a,n),this.symbols=a.symbols,this.hasEval=a.hasEval}render({self:e,parentNode:t,dynamicScope:n,mode:a}){let i,s=this.env;switch(a){case void 0:i=aa.forInitialRender(s,t,null);break;case'rehydrate':i=da.forInitialRender(s,t,null);break;case'serialize':i=pa.forInitialRender(s,t,null);break;default:throw new Error('unreachable');}let o=this.asEntryPoint().compileDynamic(s),r=Ni.initial(s,e,n,i,o);return new Pi(r)}asEntryPoint(){return this.entryPoint||(this.entryPoint=this.scanner.scanEntryPoint(this.compilationMeta())),this.entryPoint}asLayout(e,t){return this.layout||(this.layout=this.scanner.scanLayout(this.compilationMeta(),t||Yt,e)),this.layout}asPartial(){return this.partial||(this.partial=this.scanner.scanEntryPoint(this.compilationMeta(!0))),this.partial}asBlock(){return this.block||(this.block=this.scanner.scanBlock(this.compilationMeta())),this.block}compilationMeta(e=!1){return{templateMeta:this.meta,symbols:this.symbols,asPartial:e}}}class Ii extends Rn{constructor(e,t,n,a){super(e,t,a),this.template=n,this.componentFactory=a}toJSON(){return{GlimmerDebug:`<component-definition name="${this.name}">`}}}class Li{constructor(e,t=null){this._registry=e,this._resolver=t,this._lookups={},this._factoryDefinitionLookups={}}factoryFor(e){let t=this._factoryDefinitionLookups[e];return t||(this._resolver&&(t=this._resolver.retrieve(e)),!t&&(t=this._registry.registration(e)),t&&(this._factoryDefinitionLookups[e]=t)),t?this.buildFactory(e,t):void 0}lookup(e){let t=!1!==this._registry.registeredOption(e,'singleton');if(t&&this._lookups[e])return this._lookups[e];let n=this.factoryFor(e);if(n){if(!1===this._registry.registeredOption(e,'instantiate'))return n.class;let a=n.create();return t&&a&&(this._lookups[e]=a),a}}defaultInjections(){return{}}buildInjections(e){let t,n=this.defaultInjections(e),a=this._registry.registeredInjections(e);for(let s=0;s<a.length;s++)t=a[s],n[t.property]=this.lookup(t.source);return n}buildFactory(e,t){let n=this.buildInjections(e);return{class:t,create(e){let a=Object.assign({},n,e);return t.create(a)}}}}class Hi{constructor(e){this._registrations={},this._registeredOptions={},this._registeredInjections={},e&&e.fallback&&(this._fallback=e.fallback)}register(e,t,n){this._registrations[e]=t,n&&(this._registeredOptions[e]=n)}registration(e){let t=this._registrations[e];return void 0===t&&this._fallback&&(t=this._fallback.registration(e)),t}unregister(e){delete this._registrations[e],delete this._registeredOptions[e],delete this._registeredInjections[e]}registerOption(e,t,n){let a=this._registeredOptions[e];a||(a={},this._registeredOptions[e]=a),a[t]=n}registeredOption(e,t){let n,a=this.registeredOptions(e);return a&&(n=a[t]),void 0===n&&void 0!==this._fallback&&(n=this._fallback.registeredOption(e,t)),n}registeredOptions(e){let t=this._registeredOptions[e];if(t===void 0){var n=e.split(':');let a=n[0];t=this._registeredOptions[a]}return t}unregisterOption(e,t){let n=this._registeredOptions[e];n&&delete n[t]}registerInjection(e,t,n){let a=this._registeredInjections[e];a===void 0&&(this._registeredInjections[e]=a=[]),a.push({property:t,source:n})}registeredInjections(e){var t=e.split(':');let n=t[0],a=this._fallback?this._fallback.registeredInjections(e):[];return Array.prototype.push.apply(a,this._registeredInjections[n]),Array.prototype.push.apply(a,this._registeredInjections[e]),a}}const Fi='__owner__';class ji{get(e){return zi.create(this,e)}}class wi extends ji{constructor(){super(...arguments),this._lastRevision=null,this._lastValue=null}value(){let e=this.tag,t=this._lastRevision,n=this._lastValue;return t&&e.validate(t)||(n=this._lastValue=this.compute(),this._lastRevision=e.value()),n}}class Ri extends Pt{constructor(){super(...arguments),this.children=v()}get(e){let t=this.children[e];return t||(t=this.children[e]=new Vi(this.inner,e)),t}}class zi extends wi{static create(e,n){return t(e)?new Vi(e.value(),n):new Wi(e,n)}get(e){return new Wi(this,e)}}class Vi extends zi{constructor(e,t){super(),this._parentValue=e,this._propertyKey=t,this.tag=D(e,t,Fe)}compute(){return this._parentValue[this._propertyKey]}}class Wi extends zi{constructor(e,t){super();let n=e.tag,a=Tt.create(vt);this._parentReference=e,this._parentObjectTag=a,this._propertyKey=t,this.tag=s([n,a])}compute(){let e=this._parentReference,t=this._parentObjectTag,n=this._propertyKey,a=e.value();return t.inner.update(D(a,n)),'string'==typeof a&&'length'===n?a.length:'object'==typeof a&&a?a[n]:void 0}}class Ui{constructor(e,t,n){let a=e.componentFactory,i=e.name;this.args=t;let s={debugName:i,args:this.namedArgsSnapshot()};He(s,n),this.component=a.create(s)}get tag(){return this.args.tag}namedArgsSnapshot(){return Object.freeze(this.args.named.value())}}class Ki{constructor(e,t){this.template=t,this.name=e}compile(e){e.fromLayout(this.name,this.template)}}class Gi{static create(e){return new Gi(e)}constructor(e){this.env=e.env}prepareArgs(){return null}create(e,t,n){let a=Le(this.env);return new Ui(t,n.capture(),a)}createComponentDefinition(e,t,n){return n||(n={class:on,create(e){return this.class.create(e)}}),new Ii(e,this,t,n)}layoutFor(e){let t=e.template;return te(new Ki(e.name,t),this.env)}getSelf(e){return new Ri(e.component)}didCreateElement(e,t){e&&(e.component.element=t)}didRenderLayout(){}didCreate(e){e&&e.component.didInsertElement()}getTag({tag:e}){return e}update(){}didUpdateLayout(){}didUpdate(e){if(e){let t=e.component;t.args=e.namedArgsSnapshot(),t.didUpdate()}}getDestructor(e){return e.component}}class Xi{constructor(e,t){this.cache=je,this.inner=null,this.chains=null,this.lastParentValue=je,this._guid=0,this.tag=kt,this.parent=e,this.property=t}value(){let e=this.lastParentValue,t=this.property,n=this.inner,a=this._parentValue();if(null===a||a===void 0)return this.cache=void 0;if(e===a)n=this.inner;else{let e='object'==typeof a?ts.for(a).referenceTypeFor(t):ns;n=this.inner=new e(a,t,this)}return this.cache=n.value()}get(e){let t=this._getChains();return e in t?t[e]:t[e]=new Xi(this,e)}label(){return'[reference Direct]'}_getChains(){return this.chains?this.chains:this.chains=v()}_parentValue(){let e=this.parent.value();return this.lastParentValue=e,e}}class Yi{constructor(e){this.chains=v(),this.tag=kt,this.object=e}value(){return this.object}update(e){this.object=e}get(e){let t=this.chains;return e in t?t[e]:t[e]=new Xi(this,e)}chainFor(e){let t=this.chains;return e in t?t[e]:null}path(e){return e.split('.').reduce((e,t)=>e.get(t),this)}referenceFromParts(e){return e.reduce((e,t)=>e.get(t),this)}label(){return'[reference Root]'}}const Qi={destroy(){}};class Zi{constructor(e){this.tag=kt,this.parent=e}chain(){return Qi}notify(){}value(){return this.parent[this.property]}get(e){return new Zi(this.parent[this.property],e)}}class Ji{constructor(e){this.tag=kt,this.inner=e}update(e){this.inner=e}chain(){return Qi}notify(){}value(){return this.inner}referenceFromParts(){throw new Error('Not implemented')}chainFor(){throw new Error('Not implemented')}get(e){return new Zi(this.inner,e)}}class qi{constructor(e){this.object=e}root(){return new Ji(this.object)}}const $i='df8be4c8-4e89-44e2-a8f9-550c8dacdca7',es=Object.hasOwnProperty;class ts{constructor(e,{RootReferenceFactory:t,DefaultPathReferenceFactory:n}){this.references=null,this.slots=null,this.referenceTypes=null,this.propertyMetadata=null,this.object=e,this.RootReferenceFactory=t||Yi,this.DefaultPathReferenceFactory=n||ns}static for(e){if(null===e||e===void 0)return new ts(e,{});if(es.call(e,'_meta')&&e._meta)return e._meta;if(!Object.isExtensible(e))return new qi(e);let t=ts;if(e.constructor&&e.constructor[$i]){let n=e.constructor[$i];t=n.InstanceMetaConstructor}else e[$i]&&(t=e[$i].InstanceMetaConstructor);return e._meta=new t(e,{})}static exists(e){return'object'==typeof e&&e._meta}static metadataForProperty(){return null}addReference(e,t){let n=this.references=this.references||v(),a=n[e]=n[e]||new Rt;a.add(t)}addReferenceTypeFor(e,t){this.referenceTypes=this.referenceTypes||v(),this.referenceTypes[e]=t}referenceTypeFor(e){return this.referenceTypes?this.referenceTypes[e]||ns:ns}removeReference(e,t){if(this.references){let n=this.references[e];n.delete(t)}}getReferenceTypes(){return this.referenceTypes=this.referenceTypes||v(),this.referenceTypes}referencesFor(e){return this.references?this.references[e]:null}getSlots(){return this.slots=this.slots||v()}root(){return this.rootCache=this.rootCache||new this.RootReferenceFactory(this.object)}}class ns{constructor(e,t){this.tag=kt,this.object=e,this.property=t}value(){return this.object[this.property]}label(){return'[reference Property]'}}class as{constructor(e,t){this._registry=e,this._resolver=t}register(e,t,n){let a=this._toAbsoluteSpecifier(e);this._registry.register(a,t,n)}registration(e){let t=this._toAbsoluteSpecifier(e);return this._registry.registration(t)}unregister(e){let t=this._toAbsoluteSpecifier(e);this._registry.unregister(t)}registerOption(e,t,n){let a=this._toAbsoluteOrTypeSpecifier(e);this._registry.registerOption(a,t,n)}registeredOption(e,t){let n=this._toAbsoluteOrTypeSpecifier(e);return this._registry.registeredOption(n,t)}registeredOptions(e){let t=this._toAbsoluteOrTypeSpecifier(e);return this._registry.registeredOptions(t)}unregisterOption(e,t){let n=this._toAbsoluteOrTypeSpecifier(e);this._registry.unregisterOption(n,t)}registerInjection(e,t,n){let a=this._toAbsoluteOrTypeSpecifier(e),i=this._toAbsoluteSpecifier(n);this._registry.registerInjection(a,t,i)}registeredInjections(e){let t=this._toAbsoluteOrTypeSpecifier(e);return this._registry.registeredInjections(t)}_toAbsoluteSpecifier(e,t){return this._resolver.identify(e,t)}_toAbsoluteOrTypeSpecifier(e){return we(e)?e:this._toAbsoluteSpecifier(e)}}class is{constructor(e=null){this.bucket=e?f({},e):{}}get(e){return this.bucket[e]}set(e,t){return this.bucket[e]=t}child(){return new is(this.bucket)}}class ss{constructor(e,t){this.position=0,this.array=e,this.keyFor=t}isEmpty(){return 0===this.array.length}next(){let e=this.position,t=this.array,n=this.keyFor;if(e>=t.length)return null;let a=t[e],i=n(a,e);return this.position++,{key:i,value:a,memo:e}}}class os{constructor(e,t,n){this.position=0,this.keys=e,this.values=t,this.keyFor=n}isEmpty(){return 0===this.keys.length}next(){let e=this.position,t=this.keys,n=this.values,a=this.keyFor;if(e>=t.length)return null;let i=n[e],s=t[e],o=a(i,s);return this.position++,{key:o,value:i,memo:s}}}const rs=new class{isEmpty(){return!0}next(){throw new Error(`Cannot call next() on an empty iterator`)}};class ds{constructor(e,t){this.tag=e.tag,this.ref=e,this.keyFor=t}iterate(){let e=this.ref,t=this.keyFor,n=e.value();if(Array.isArray(n))return 0<n.length?new ss(n,t):rs;if(void 0===n||null===n)return rs;if(void 0!==n.forEach){let e=[];return n.forEach(function(t){e.push(t)}),0<e.length?new ss(e,t):rs}if('object'==typeof n){let e=Object.keys(n);return 0<e.length?new os(e,e.map((e)=>n[e]),t):rs}throw new Error(`Don't know how to {{#each ${n}}}`)}valueReferenceFor(e){return new Yi(e.value)}updateValueReference(e,t){e.update(t.value)}memoReferenceFor(e){return new Yi(e.memo)}updateMemoReference(e,t){e.update(t.memo)}}class ps{constructor(e,t,n){this.nameRef=e,this.env=t,this.meta=n,this.tag=e.tag}value(){let e=this.env,t=this.nameRef,n=t.value();return'string'==typeof n?e.getComponentDefinition(n,this.meta):null}get(){return fn}}class ls{constructor(e,t){this.tag=kt,this.parent=e,this.property=t}value(){return this.parent.value()[this.property]}get(e){return new ls(this,e)}}class cs{constructor(e,t){this.tag=kt,this.helper=e,this.args=t.capture()}value(){let e=this.helper,t=this.args;return e(t.positional.value(),t.named.value())}get(e){return new ls(this,e)}}class us extends Rn{toJSON(){return`<default-component-definition name=${this.name}>`}}const ms={action:function(e,t){let n=e.getSelf(),a=t.capture(),i=a.positional.at(0).value();return'function'!=typeof i&&Ue(i,a.positional.at(0)),new Pt(function(...e){let t=a.positional.value();t.shift(),t.push(...e),i.apply(n&&n.value(),t)})}};class fs extends Si{constructor(e){super({appendOperations:e.appendOperations,updateOperations:new oi(e.document||document)}),this.helpers=v(),this.modifiers=v(),this.components=v(),this.managers=v(),He(this,Le(e)),this.uselessAnchor=e.document.createElement('a')}static create(e={}){return e.document=e.document||self.document,e.appendOperations=e.appendOperations||new ri(e.document),new fs(e)}protocolForURL(e){return this.uselessAnchor.href=e,this.uselessAnchor.protocol}hasPartial(){return!1}lookupPartial(){}managerFor(e='main'){let t;if(t=this.managers[e],!t){let n=Le(this);if(t=this.managers[e]=Le(this).lookup(`component-manager:/${n.rootName}/component-managers/${e}`),!t)throw new Error(`No component manager found for ID ${e}.`)}return t}hasComponentDefinition(e,t){return!!this.identifyComponent(e,t)}getComponentDefinition(e,t){let n=Le(this),a=p(this.identifyComponent(e,t));return this.components[a]?this.components[a]:this.registerComponent(e,a,t,n)}registerComponent(e,t,n,a){let i=a.lookup('template',t),s=a.identify('component',t),o=null;s&&(o=a.factoryFor(s));let r,d=Ie(i).create(this),p=this.managerFor(i.meta.managerId);return r=Qe(p)?p.createComponentDefinition(e,d,o):new us(e,p,o),this.components[t]=r,r}hasHelper(e,t){return!!this.lookupHelper(e,t)}lookupHelper(e,t){if(ms[e])return ms[e];let n=Le(this),a=`helper:${e}`,i=t.specifier,s=n.identify(a,i);return void 0===s?void 0:this.helpers[s]?this.helpers[s]:this.registerHelper(s,n)}registerHelper(e,t){let n=t.lookup(e),a=Xe(n);return this.helpers[e]=a,a}hasModifier(e){return 1===e.length&&e in this.modifiers}lookupModifier(e){let t=this.modifiers[e];if(!t)throw new Error(`Modifier for ${e} not found.`);return t}iterableFor(e,t){let n;if(!t)throw new Error('Must specify a key for #each');switch(t){case'@index':n=(e,t)=>t+'';break;case'@primitive':n=(e)=>e+'';break;default:n=(e)=>e[t];}return new ds(e,n)}macros(){let e=super.macros();return Ye(e.blocks,e.inlines),e}identifyComponent(e,t){let n=Le(this),a=`template:${e}`,i=t.specifier,s=n.identify(a,i);if(s===void 0&&n.identify(`component:${e}`,i))throw new Error(`The component '${e}' is missing a template. All components must have a template. Make sure there is a template.hbs in the component directory.`);return s}}var gs={id:'UN61+JFU',block:'{"symbols":["root"],"statements":[[4,"each",[[19,0,["roots"]]],[["key"],["id"]],{"statements":[[4,"-in-element",[[19,1,["parent"]]],[["nextSibling"],[[19,1,["nextSibling"]]]],{"statements":[[1,[25,"component",[[19,1,["component"]]],null],false]],"parameters":[]},null]],"parameters":[1]},null]],"hasEval":false}',meta:{specifier:'template:/-application/templates/main'}};class hs{constructor(e){this._roots=[],this._rootsIndex=0,this._initializers=[],this._initialized=!1,this._rendering=!1,this._rendered=!1,this._scheduled=!1,this._rerender=Ze,this.rootName=e.rootName,this.resolver=e.resolver,this.document=e.document||window.document}registerInitializer(e){this._initializers.push(e)}initRegistry(){let e=this._registry=new Hi,t=new as(this._registry,this.resolver);e.register(`environment:/${this.rootName}/main/main`,fs),e.registerOption('helper','instantiate',!1),e.registerOption('template','instantiate',!1),e.register(`document:/${this.rootName}/main/main`,this.document),e.registerOption('document','instantiate',!1),e.registerInjection('environment','document',`document:/${this.rootName}/main/main`),e.registerInjection('component-manager','env',`environment:/${this.rootName}/main/main`);let n=this._initializers;for(let e=0;e<n.length;e++)n[e].initialize(t);this._initialized=!0}initContainer(){this._container=new Li(this._registry,this.resolver),this._container.defaultInjections=()=>{let e={};return He(e,this),e}}initialize(){this.initRegistry(),this.initContainer()}boot(){this.initialize(),this.env=this.lookup(`environment:/${this.rootName}/main/main`),this.render()}render(){this.env.begin();let e,t=Ie(gs).create(this.env),n=new Yi({roots:this._roots}),a=this.document,i=a.body,s=new is,o=t.render({self:n,parentNode:i,dynamicScope:s});do e=o.next();while(!e.done);this.env.commit();let r=e.value;this._rerender=()=>{this.env.begin(),r.rerender(),this.env.commit(),this._didRender()},this._didRender()}_didRender(){this._rendered=!0}renderComponent(e,t,n=null){this._roots.push({id:this._rootsIndex++,component:e,parent:t,nextSibling:n}),this.scheduleRerender()}scheduleRerender(){this._scheduled||!this._rendered||(this._rendering=!0,this._scheduled=!0,requestAnimationFrame(()=>{this._scheduled=!1,this._rerender(),this._rendering=!1}))}identify(e,t){return this.resolver.identify(e,t)}factoryFor(e,t){return this._container.factoryFor(this.identify(e,t))}lookup(e,t){return this._container.lookup(this.identify(e,t))}}class ys{constructor(e,t){this.config=e,this.registry=t}identify(e,t){if(Je(e))return e;let n,a=tt(e);if(t){let e=tt(t);if(qe(e)){if(nt('Specifier must not include a rootName, collection, or namespace when combined with an absolute referrer',void 0===a.rootName&&void 0===a.collection&&void 0===a.namespace),a.rootName=e.rootName,a.collection=e.collection,a.name?a.namespace=e.namespace?e.namespace+'/'+e.name:e.name:(a.namespace=e.namespace,a.name=e.name),n=this._serializeAndVerify(a))return n;let t=this._definitiveCollection(a.type);if(t&&(a.namespace+='/-'+t,n=this._serializeAndVerify(a)))return n;a.rootName=a.collection=a.namespace=void 0}else nt('Referrer must either be "absolute" or include a `type` to determine the associated type',e.type),a.collection=this._definitiveCollection(e.type),nt(`'${e.type}' does not have a definitive collection`,a.collection)}if(a.collection||(a.collection=this._definitiveCollection(a.type),nt(`'${a.type}' does not have a definitive collection`,a.collection)),!a.rootName){if(a.rootName=this.config.app.rootName||'app',n=this._serializeAndVerify(a))return n;let e;a.namespace?(e=this.config.addons&&this.config.addons[a.namespace],a.rootName=a.namespace,a.namespace=void 0):(e=this.config.addons&&this.config.addons[a.name],a.rootName=a.name,a.name='main')}return(n=this._serializeAndVerify(a))?n:void 0}retrieve(e){return this.registry.get(e)}resolve(e,t){let n=this.identify(e,t);if(n)return this.retrieve(n)}_definitiveCollection(e){let t=this.config.types[e];return nt(`'${e}' is not a recognized type`,t),t.definitiveCollection}_serializeAndVerify(e){let t=$e(e);if(this.registry.has(t))return t}}class bs{constructor(e={}){this._entries=e}has(e){return e in this._entries}get(e){return this._entries[e]}}class vs{constructor(e){this.position=e.position,this.velocity=e.velocity,this.radius=e.size,this.lifeSpan=e.lifeSpan,this.inertia=0.98}destroy(){this.delete=!0}render(e){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.velocity.x*=this.inertia,this.velocity.y*=this.inertia,this.radius-=0.1,0.1>this.radius&&(this.radius=0.1),0>this.lifeSpan--&&this.destroy();const t=e.context;t.save(),t.translate(this.position.x,this.position.y),t.fillStyle='#ffffff',t.lineWidth=2,t.beginPath(),t.moveTo(0,-this.radius),t.arc(0,0,this.radius,0,2*rt),t.closePath(),t.fill(),t.restore()}}const ks=new Image;ks.src='data:image/png;base64,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';class Ss{constructor(e){this.position=e.position,this.velocity={x:at(-1.5,1.5),y:at(-1.5,1.5)},this.rotation=0,this.rotationSpeed=at(-1,1),this.radius=e.size,this.score=5*(80/this.radius),this.create=e.create,this.addScore=e.addScore,this.vertices=ot(8,e.size),this.imageOffset={x:at(0.3*-this.radius,0.3*this.radius),y:at(0.3*-this.radius,0.3*this.radius)}}destroy(){this.delete=!0,this.addScore(this.score);for(let e=0;e<this.radius;e++){const e=new vs({lifeSpan:at(60,100),size:at(1,3),position:{x:this.position.x+at(-this.radius/4,this.radius/4),y:this.position.y+at(-this.radius/4,this.radius/4)},velocity:{x:at(-1.5,1.5),y:at(-1.5,1.5)}});this.create(e,'particles')}if(10<this.radius)for(let e,t=0;2>t;t++)e=new Ss({size:this.radius/2,position:{x:at(-10,20)+this.position.x,y:at(-10,20)+this.position.y},create:this.create.bind(this),addScore:this.addScore.bind(this)}),this.create(e,'asteroids')}render(e){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.rotation+=this.rotationSpeed,360<=this.rotation&&(this.rotation-=360),0>this.rotation&&(this.rotation+=360),this.position.x>e.screen.width+this.radius?this.position.x=-this.radius:this.position.x<-this.radius&&(this.position.x=e.screen.width+this.radius),this.position.y>e.screen.height+this.radius?this.position.y=-this.radius:this.position.y<-this.radius&&(this.position.y=e.screen.height+this.radius);const t=e.context;t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.rotation*rt/180),t.strokeStyle='#FFF',t.lineWidth=2,t.beginPath(),t.moveTo(0,-this.radius);for(let n=1;n<this.vertices.length;n++)t.lineTo(this.vertices[n].x,this.vertices[n].y);t.closePath(),t.clip(),t.drawImage(ks,1.5*-this.radius+this.imageOffset.x,1.5*-this.radius+this.imageOffset.y,3*this.radius,3*this.radius),t.stroke(),t.restore()}}class Cs{constructor(e){let t=st({x:0,y:-20},{x:0,y:0},e.ship.rotation*rt/180);this.position={x:e.ship.position.x+t.x,y:e.ship.position.y+t.y},this.rotation=e.ship.rotation,this.velocity={x:t.x/2+0.7*e.ship.velocity.x,y:t.y/2+0.7*e.ship.velocity.y},this.radius=2}destroy(){this.delete=!0}render(e){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,(0>this.position.x||0>this.position.y||this.position.x>e.screen.width||this.position.y>e.screen.height)&&this.destroy();const t=e.context;t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.rotation*rt/180),t.fillStyle='#FFF',t.lineWidth=0.5,t.beginPath(),t.arc(0,0,2,0,2*rt),t.closePath(),t.fill(),t.restore()}}class As{constructor(e){this.position=e.position,this.velocity=e.velocity,this.radius=e.size,this.lifeSpan=e.lifeSpan,this.inertia=0.98}destroy(){this.delete=!0}render(e){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.velocity.x*=this.inertia,this.velocity.y*=this.inertia,this.radius-=0.1,0.1>this.radius&&(this.radius=0.1),0>this.lifeSpan--&&this.destroy();const t=e.context;t.save(),t.translate(this.position.x,this.position.y),t.fillStyle='#ffffff',t.lineWidth=2,t.beginPath(),t.moveTo(0,-this.radius),t.arc(0,0,this.radius,0,2*rt),t.closePath(),t.fill(),t.restore()}}class xs{constructor(e){this.position=e.position,this.velocity={x:0,y:0},this.rotation=0,this.rotationSpeed=6,this.speed=0.15,this.inertia=0.99,this.radius=20,this.lastShot=0,this.create=e.create,this.onDie=e.onDie}destroy(){this.delete=!0,this.onDie();for(let e=0;60>e;e++){const e=new As({lifeSpan:at(60,100),size:at(1,4),position:{x:this.position.x+at(-this.radius/4,this.radius/4),y:this.position.y+at(-this.radius/4,this.radius/4)},velocity:{x:at(-1.5,1.5),y:at(-1.5,1.5)}});this.create(e,'particles')}}rotate(e){'LEFT'===e&&(this.rotation-=this.rotationSpeed),'RIGHT'===e&&(this.rotation+=this.rotationSpeed)}accelerate(){this.velocity.x-=dt(-this.rotation*rt/180)*this.speed,this.velocity.y-=pt(-this.rotation*rt/180)*this.speed;let e=st({x:0,y:-10},{x:0,y:0},(this.rotation-180)*rt/180);const t=new As({lifeSpan:at(20,40),size:at(1,3),position:{x:this.position.x+e.x+at(-2,2),y:this.position.y+e.y+at(-2,2)},velocity:{x:e.x/at(3,5),y:e.y/at(3,5)}});this.create(t,'particles')}render(e){if(e.keys.up&&this.accelerate(),e.keys.left&&this.rotate('LEFT'),e.keys.right&&this.rotate('RIGHT'),e.keys.space&&300<Date.now()-this.lastShot){const e=new Cs({ship:this});this.create(e,'bullets'),this.lastShot=Date.now()}this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.velocity.x*=this.inertia,this.velocity.y*=this.inertia,360<=this.rotation&&(this.rotation-=360),0>this.rotation&&(this.rotation+=360),this.position.x>e.screen.width?this.position.x=0:0>this.position.x&&(this.position.x=e.screen.width),this.position.y>e.screen.height?this.position.y=0:0>this.position.y&&(this.position.y=e.screen.height);const t=e.context;t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.rotation*rt/180),t.strokeStyle='#ffffff',t.fillStyle='#000000',t.lineWidth=2,t.beginPath(),t.moveTo(0,-15),t.lineTo(10,10),t.lineTo(5,7),t.lineTo(-5,7),t.lineTo(-10,10),t.closePath(),t.fill(),t.stroke(),t.restore()}}var Es=function(e,t,n,a){var s,o=arguments.length,d=3>o?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)d=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;0<=r;r--)(s=e[r])&&(d=(3>o?s(d):3<o?s(t,n,d):s(t,n))||d);return 3<o&&d&&Object.defineProperty(t,n,d),d};const Ts={LEFT:37,RIGHT:39,UP:38,A:65,D:68,W:87,SPACE:32},_s=3;var Ds;(function(e){e[e.Welcome=0]='Welcome',e[e.Running=1]='Running',e[e.GameOver=2]='GameOver'})(Ds||(Ds={}));class Bs extends on{constructor(e){super(e),this.GameState=Ds,this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleResize=this.handleResize.bind(this),this.state={screen:{width:window.innerWidth,height:window.innerHeight,ratio:window.devicePixelRatio||1},context:null,keys:{left:!1,right:!1,up:!1,down:!1,space:!1},asteroidCount:_s,currentScore:0,topScore:localStorage.topscore||0,gameState:Ds.Welcome},this.ship=[],this.asteroids=[],this.bullets=[],this.particles=[]}get gameOverMessage(){return 0>=this.state.currentScore?'0 points... So sad.':this.state.currentScore>=this.state.topScore?'Top score with '+this.state.currentScore+' points. Woo!':this.state.currentScore+' Points though :)'}get canvasSize(){return{width:this.state.screen.width*this.state.screen.ratio,height:this.state.screen.height*this.state.screen.ratio}}handleResize(){this.state=Object.assign({},this.state,{screen:{width:window.innerWidth,height:window.innerHeight,ratio:window.devicePixelRatio||1}})}handleKeyUp(e){this.handleKeys(!1,e)}handleKeyDown(e){this.handleKeys(!0,e)}handleKeys(e,t){let n=this.state.keys;(t.keyCode===Ts.LEFT||t.keyCode===Ts.A)&&(n.left=e),(t.keyCode===Ts.RIGHT||t.keyCode===Ts.D)&&(n.right=e),(t.keyCode===Ts.UP||t.keyCode===Ts.W)&&(n.up=e),t.keyCode===Ts.SPACE&&(n.space=e),this.state=Object.assign({},this.state,{keys:n})}didInsertElement(){window.addEventListener('keyup',this.handleKeyUp),window.addEventListener('keydown',this.handleKeyDown),window.addEventListener('resize',this.handleResize);const e=this.element.querySelector('canvas').getContext('2d');this.state=Object.assign({},this.state,{context:e}),requestAnimationFrame(()=>this.update())}willDestroy(){window.removeEventListener('keyup',this.handleKeyUp),window.removeEventListener('keydown',this.handleKeyDown),window.removeEventListener('resize',this.handleResize)}update(){const e=this.state.context;if(e.save(),e.scale(this.state.screen.ratio,this.state.screen.ratio),e.fillStyle='#000',e.globalAlpha=0.4,e.fillRect(0,0,this.state.screen.width,this.state.screen.height),e.globalAlpha=1,!this.asteroids.length){let e=this.state.asteroidCount+1;this.state=Object.assign({},this.state,{asteroidCount:e}),this.generateAsteroids(e)}this.checkCollisionsWith(this.bullets,this.asteroids),this.checkCollisionsWith(this.ship,this.asteroids),this.updateObjects(this.particles,'particles'),this.updateObjects(this.asteroids,'asteroids'),this.updateObjects(this.bullets,'bullets'),this.updateObjects(this.ship,'ship'),e.restore(),requestAnimationFrame(()=>this.update())}addScore(e){this.state.gameState===Ds.Running&&(this.state=Object.assign({},this.state,{currentScore:this.state.currentScore+e}))}startGame(){this.state=Object.assign({},this.state,{gameState:Ds.Running,currentScore:0,asteroidCount:_s});let e=new xs({position:{x:this.state.screen.width/2,y:this.state.screen.height/2},create:this.createObject.bind(this),onDie:this.gameOver.bind(this)});this.createObject(e,'ship'),this.asteroids=[],this.generateAsteroids(this.state.asteroidCount)}gameOver(){this.state=Object.assign({},this.state,{gameState:Ds.GameOver}),this.state.currentScore>this.state.topScore&&(this.state=Object.assign({},this.state,{topScore:this.state.currentScore}),localStorage.setItem('topscore',this.state.currentScore+''))}generateAsteroids(e){let t=this.ship[0],n=t?t.position:{x:this.state.screen.width/2,y:this.state.screen.height/2};for(let t,a=0;a<e;a++)t=new Ss({size:80,position:{x:it(0,this.state.screen.width,n.x-60,n.x+60),y:it(0,this.state.screen.height,n.y-60,n.y+60)},create:this.createObject.bind(this),addScore:this.addScore.bind(this)}),this.createObject(t,'asteroids')}createObject(e,t){'asteroids'===t?this.asteroids.push(e):'ship'===t?this.ship.push(e):'particles'===t?this.particles.push(e):'bullets'===t&&this.bullets.push(e)}updateObjects(e,t){for(let n,a=0;a<e.length;a++)n=e[a],n.delete?this[t].splice(a,1):n.render(this.state)}checkCollisionsWith(e,t){for(let n,i=0;i<e.length;i++){n=e[i];for(let e,a=0;a<t.length;a++)e=t[a],this.checkCollision(n,e)&&(n.destroy(),e.destroy())}}checkCollision(e,t){let n=e.position.x-t.position.x,a=e.position.y-t.position.y,i=Math.sqrt(n*n+a*a);return!!(i<e.radius+t.radius)}}Es([k],Bs.prototype,'state',void 0),Es([k('state')],Bs.prototype,'gameOverMessage',null),Es([k('state')],Bs.prototype,'canvasSize',null);var Ns={"helper:/glimmeroids-app/components/eq":function([e,t]){return e===t},"component:/glimmeroids-app/components/glimmeroids-app":Bs,"template:/glimmeroids-app/components/glimmeroids-app":{id:'BDdlaaKt',block:'{"symbols":[],"statements":[[6,"div"],[7],[0,"\\n"],[4,"if",[[25,"not",[[25,"eq",[[19,0,["state","gameState"]],[19,0,["GameState","Welcome"]]],null]],null]],null,{"statements":[[0,"    "],[6,"div"],[9,"class","title"],[7],[0,"\\n      "],[6,"h1"],[9,"class","logo"],[7],[0,"Glimmeroids"],[8],[0,"\\n    "],[8],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"if",[[25,"not",[[25,"eq",[[19,0,["state","gameState"]],[19,0,["GameState","Running"]]],null]],null]],null,{"statements":[[0,"    "],[6,"div"],[9,"class","message"],[7],[0,"\\n"],[4,"if",[[25,"eq",[[19,0,["state","gameState"]],[19,0,["GameState","GameOver"]]],null]],null,{"statements":[[0,"        "],[6,"p"],[7],[0,"Game over, man!"],[8],[0,"\\n        "],[6,"p"],[7],[1,[18,"gameOverMessage"],false],[8],[0,"\\n"]],"parameters":[]},{"statements":[[0,"        "],[6,"h1"],[9,"class","logo"],[7],[0,"Glimmeroids"],[8],[0,"\\n"]],"parameters":[]}],[0,"\\n      "],[6,"button"],[10,"onclick",[25,"action",[[19,0,["startGame"]]],null],null],[7],[0,"\\n        "],[1,[25,"if",[[25,"eq",[[19,0,["state","gameState"]],[19,0,["GameState","GameOver"]]],null],"try again?","start the game"],null],false],[0,"\\n      "],[8],[0,"\\n    "],[8],[0,"\\n"]],"parameters":[]},null],[0,"\\n\\n  "],[6,"span"],[9,"class","score current-score"],[7],[0,"Score: "],[1,[20,["state","currentScore"]],false],[8],[0,"\\n  "],[6,"span"],[9,"class","score top-score"],[7],[0,"Top Score: "],[1,[20,["state","topScore"]],false],[8],[0,"\\n  "],[6,"span"],[9,"class","controls"],[7],[0,"\\n    Use [A][W][D] or [\u2190][\u2191][\u2192] to MOVE"],[6,"br"],[7],[8],[0,"\\n    Use [SPACE] to SHOOT\\n  "],[8],[0,"\\n  "],[6,"canvas"],[10,"width",[20,["canvasSize","width"]],null],[10,"height",[20,["canvasSize","height"]],null],[7],[8],[0,"\\n"],[8],[0,"\\n"]],"hasEval":false}',meta:{specifier:'template:/glimmeroids/components/glimmeroids-app'}},"helper:/glimmeroids-app/components/if":function([e,t,n]){return e?t:n},"helper:/glimmeroids-app/components/not":function([e]){return!e}},Ps={app:{name:'glimmeroids-app',rootName:'glimmeroids-app'},types:{application:{definitiveCollection:'main'},component:{definitiveCollection:'components'},"component-test":{unresolvable:!0},helper:{definitiveCollection:'components'},"helper-test":{unresolvable:!0},renderer:{definitiveCollection:'main'},template:{definitiveCollection:'components'}},collections:{main:{types:['application','renderer']},components:{group:'ui',types:['component','component-test','template','helper','helper-test'],defaultType:'component',privateCollections:['utils']},styles:{group:'ui',unresolvable:!0},utils:{unresolvable:!0}}};const Os=new class extends hs{constructor(){let e=new bs(Ns),t=new ys(Ps,e);super({rootName:Ps.app.rootName,resolver:t})}},Ms=document.getElementById('app');(function(e){an=e})(()=>{Os.scheduleRerender()}),Os.registerInitializer({initialize(e){e.register(`component-manager:/${Os.rootName}/component-managers/main`,Gi)}}),Os.renderComponent('glimmeroids-app',Ms,null),Os.boot()});